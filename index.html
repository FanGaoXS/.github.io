<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>FanGaoXS&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="FanGaoXS&#39;s blog">
<meta property="og:url" content="https://fangaoxs.github.io/index.html">
<meta property="og:site_name" content="FanGaoXS&#39;s blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="FanGaoXS">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="FanGaoXS's blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">FanGaoXS&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://fangaoxs.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-back-end/docker/dockerfile" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/04/back-end/docker/dockerfile/" class="article-date">
  <time class="dt-published" datetime="2024-02-04T09:27:39.000Z" itemprop="datePublished">2024-02-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/04/back-end/docker/dockerfile/">docker学习</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="dockerfile是什么"><a href="#dockerfile是什么" class="headerlink" title="dockerfile是什么"></a>dockerfile是什么</h2><p>Dockerfile是一种用于定义和构建Docker镜像的文本文件。它包含一系列指令和配置，用于构建一个可运行的Docker容器。</p>
<p>在Dockerfile中，您可以定义从哪个基础镜像开始构建、复制文件、设置环境变量、运行命令等操作。每个指令都代表一个步骤，按顺序执行，从而构建出一个完整的Docker镜像。</p>
<h2 id="go-build"><a href="#go-build" class="headerlink" title="go build"></a>go build</h2><p><code>go build</code>是Go语言的一个命令，用于将Go源代码编译成可执行文件或库。</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> golang:<span class="number">1.20</span> as builder</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /source</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . /source</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> go build -o app .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> ubuntu:noble</span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=builder /source/app /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> +x /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> APP_NAME=<span class="string">&quot;app&quot;</span></span><br><span class="line"><span class="keyword">ENV</span> APP_VERSION=<span class="string">&quot;v0.0.1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;/app&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p>示例的Dockfile包含了Docker多阶段构建，第一个用于构建Go应用程序，另一个用于最终的容器镜像。</p>
<p><strong>第一阶段：构建Go应用程序</strong></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> golang:<span class="number">1.20</span> as builder</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /source</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . /source</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> go build -o app .</span></span><br></pre></td></tr></table></figure>

<p>首先，使用<code>golang:1.20</code>作为基础镜像命名为<code>builder</code>，接着将工作目录设置为<code>/source</code>，然后将宿主机的当前目录中的所有文件复制到容器的<code>/source</code>目录下，接着执行<code>go build</code>命令，将Go源码编译为名为<code>app</code>的可执行文件。</p>
<p><strong>第二阶段：构建运行应用程序的最终容器</strong></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:noble</span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=builder /source/app /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> +x /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> APP_NAME=<span class="string">&quot;app&quot;</span></span><br><span class="line"><span class="keyword">ENV</span> APP_VERSION=<span class="string">&quot;v0.0.1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;/app&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p>首先，使用<code>ubuntu:noble</code>作为基础镜像最终的容器镜像，接着将第一阶段（<code>builder</code>阶段）的<code>/source/app</code>文件复制到容器的<code>/app</code>目录，然后运行<code>chmod +x /app</code>为<code>/app</code>添加可执行权限，然后使用<code>ENV</code>设置了一系列环境变量，最后通过<code>CMD</code>指定了容器启动时要执行的命令，即运行<code>/app</code>可执行文件。</p>
<p>示例的dockerfile使用了多阶段的构建的方式，首先在一个专门用于构建的构建容器中编译应用程序，然后再将编译好的可执行文件复制到最终的容器镜像中，这种方式可以减小最终镜像的大小，因为这种最终得到的docker镜像只会包含最终容器和可执行文件，而没有编译该可执行文件需要的编译环境。</p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>使用dockerfile来构建此类应用程序简单的思路大致就是使用两个构建阶段，第一个阶段的目的就是编译该应用程序，第二阶段就是将该应用程序复制到最终容器中。</p>
<p>其中第一阶段的步骤大致是，选定基础镜像，指定工作目录，将宿主机的源代码复制到容器的工作目录中，然后执行编译得到可执行文件。</p>
<p>第二阶段的步骤大致是，选定最终容器的镜像，然后将第一阶段编译出的可执行文件复制到现容器中，设置环境变量，定义运行命令。</p>
<p>示例这里是Go的应用程序，Java的应用程序同理：第一阶段选定Java的构建环境，如<code>From:java</code>，然后将Java源码构建为jar包，接着在第二阶段指定jar文件运行需要的环境，最后执行jar应用程序。</p>
<h2 id="常见命令"><a href="#常见命令" class="headerlink" title="常见命令"></a>常见命令</h2><table>
<thead>
<tr>
<th>Dockfile指令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>FROM</td>
<td>指定基础镜像，作为后续指令的基础</td>
</tr>
<tr>
<td>WORKDIR</td>
<td>设置后续指令的工作目录</td>
</tr>
<tr>
<td>RUN</td>
<td>在构建过程中执行的命令</td>
</tr>
<tr>
<td>COPY</td>
<td>将宿主机文件或目录复制到镜像中</td>
</tr>
<tr>
<td>ENV</td>
<td>设置容器内部的环境变量</td>
</tr>
<tr>
<td>CMD</td>
<td>指定容器运行时的默认命令（可以被覆盖）</td>
</tr>
<tr>
<td>ENTRYPOINT</td>
<td>指定容器运行时的主要命令（不可以被覆盖，必须执行）</td>
</tr>
</tbody></table>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h3 id="build"><a href="#build" class="headerlink" title="build"></a>build</h3><p>编写好Dockerfile后，使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker build -t &lt;image_name&gt; .</span><br><span class="line"></span><br><span class="line"><span class="comment">## -t 指定创建的目标镜像名</span></span><br></pre></td></tr></table></figure>

<p>build镜像。</p>
<h3 id="run"><a href="#run" class="headerlink" title="run"></a>run</h3><p>可以使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run &lt;image_name&gt;</span><br></pre></td></tr></table></figure>

<p>以容器的方式运行镜像</p>
<p>或者使用<strong>docker-compose</strong>来运行镜像。</p>
<p>始终牢记，docker的镜像无论如何都是运行在容器当中的，所以可以执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it &lt;image_name&gt; bash</span><br></pre></td></tr></table></figure>

<p>以容器的方式运行镜像，上述方法能够在编写Dockerfile的时候方便以容器的方式运行镜像并且观察镜像的环境，从而检查Dockerfile编写是否存在问题。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2024/02/04/back-end/docker/dockerfile/" data-id="clsblyudy000ow0k6gt6h1yzk" data-title="docker学习" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dockerfile/" rel="tag">dockerfile</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-data-structure/手写ArrayList/ArrayList整合Java" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/19/data-structure/%E6%89%8B%E5%86%99ArrayList/ArrayList%E6%95%B4%E5%90%88Java/" class="article-date">
  <time class="dt-published" datetime="2023-07-19T07:30:39.000Z" itemprop="datePublished">2023-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/19/data-structure/%E6%89%8B%E5%86%99ArrayList/ArrayList%E6%95%B4%E5%90%88Java/">利用Java来手写ArrayList</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>几乎所有的语言都会有数组，Java也不例外。数组有个特点就是在初始化的时候必须确定长度，即使容量到达了也无法自动扩容，无法满足需求，所以我们可以利用动态数组（ArrayList）来实现可以自动扩容的数组。参考Java官方的ArrayList实现：<code>java.util.ArrayList</code>。ArrayList的底层还是数组，相当于数组的强化版，能够进行自动扩容并且进行数据的增删改查。</p>
<blockquote>
<p><strong>注意：</strong></p>
<p>以下利用<strong>动态数组</strong>来表示<code>ArrayList</code>，利用<strong>数组</strong>来表示<code>Object[]</code></p>
</blockquote>
<h2 id="私有属性"><a href="#私有属性" class="headerlink" title="私有属性"></a>私有属性</h2><p>最起码需要表示动态数组的大小<code>size</code>，存放数据的基本数组<code>elements[]</code>，所以应该有以下属性：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayList</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> E[] elements;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意这里使用到了泛型，是为了方便顺序存储相似的数据（类型相同的数据）</p>
<h2 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h2><p>无参构造方法：创建一个默认容量的数组；</p>
<p>有参构造方法：创建一个指定容量的数组。</p>
<p>既然涉及到默认，那我们可以指定一个常量为默认容量，可以按照自己的需求来，随便多少都可以。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 动态数组默认容量</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_CAPACITY</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 无参构造，创建默认大小的数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 有参构造，根据容量创建数组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> capacity      自定义容量</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">(<span class="type">int</span> capacity)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>注意：</strong></p>
<p>容量（capacity）是指该动态数组能够容纳多少个元素，而不代表它里面已经存了多少个元素，通常情况数组的长度<code>elements.length</code>和他相等。</p>
<p>大小（size）是指该动态数组已经有多少个元素。</p>
</blockquote>
<h3 id="无参构造"><a href="#无参构造" class="headerlink" title="无参构造"></a>无参构造</h3><p>创建默认容量的Object数组，再强制类型转换。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">()</span>&#123;</span><br><span class="line">    elements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="有参构造"><a href="#有参构造" class="headerlink" title="有参构造"></a>有参构造</h3><p>创建指定容量的数组，需要控制一下传入的容量大小，不允许为负数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">(<span class="type">int</span> capacity)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (capacity&lt;=<span class="number">0</span>) capacity = DEFAULT_CAPACITY; <span class="comment">//如果传入容量不为自然数，则强制为默认容量</span></span><br><span class="line">    elements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[capacity];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="基本方法"><a href="#基本方法" class="headerlink" title="基本方法"></a>基本方法</h2><p>仿造<code>java.util.ArrayList</code>，得出以下基本方法包含基本的添加删除查询元素等。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayList</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组大小</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>      动态数组大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组是否为空</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>      动态数组是否为空</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">isEmpty</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"><span class="comment">     *  1 2 3   4 5 6 7 8</span></span><br><span class="line"><span class="comment">     * 向指定位置添加元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"><span class="comment">     *  a b c 1 d e f g h</span></span><br><span class="line"><span class="comment">     * 移除指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除指定元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 清空动态数组中的元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index      位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获得指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>          元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断数组是否包含该元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>           true包含，false不包含</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">contains</span><span class="params">(E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该元素第一次出现的下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>           下标</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="size"><a href="#size" class="headerlink" title="size()"></a>size()</h3><p>返回动态数组的大小</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="isEmpty"><a href="#isEmpty" class="headerlink" title="isEmpty()"></a>isEmpty()</h3><p>返回动态数组是否为空，判断size是否为0</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Boolean <span class="title function_">isEmpty</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString()"></a>toString()</h3><p>打印动态数组，这个按照自己的需求来就可以了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">string</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    string.append(<span class="string">&quot;ArrayList&#123;&quot;</span>);</span><br><span class="line">    string.append(<span class="string">&quot;size=&quot;</span> + size + <span class="string">&quot;, elements=[&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        string.append(elements[i]);</span><br><span class="line">        <span class="keyword">if</span> (i != size -<span class="number">1</span>) &#123; <span class="comment">//最后一个元素末尾不添加逗号</span></span><br><span class="line">            string.append(<span class="string">&quot;, &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    string.append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">    string.append(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> string.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="indexOf-和contains"><a href="#indexOf-和contains" class="headerlink" title="indexOf()和contains()"></a>indexOf()和contains()</h3><p>indexOf()返回的元素第一次出现的下标（循环数组，如果有该元素则返回下标，下标为-1则表示没有该元素）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (elements[i].equals(element)) <span class="keyword">return</span> i; <span class="comment">//如果element存在返回下标</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>contains()判断是否存在该元素，利用indexOf()来判断，如果存在下标则说明存在该元素，不存在下标则不存在该元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Boolean <span class="title function_">contains</span><span class="params">(E element)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> indexOf(element) &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="get"><a href="#get" class="headerlink" title="get()"></a>get()</h3><p>返回指定下标的数组元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> elements[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="set"><a href="#set" class="headerlink" title="set()"></a>set()</h3><p>向指定下标塞入元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;</span><br><span class="line">    elements[index] = element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="add"><a href="#add" class="headerlink" title="add()"></a>add()</h3><p>添加元素，向动态数组末尾添加元素。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span>&#123;</span><br><span class="line">    elements[size] = element;</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重载方法add(int index, E element)向指定位置添加元素，原来的元素会依次向后挪动。元素挪动的目的是为了空出index下标的元素，所以index下标及其后面的元素都需要<strong>依次往后挪动</strong>。挪动的顺序应是</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99ArrayList/ArrayList%E6%95%B4%E5%90%88Java/image-20210818184937456.png"></p>
<p>注意第一是先挪动最后一个，如果你从index才是挪动后面的会被覆盖。依次挪动然后index下标处元素就会被空出来，然后塞入要插入的元素即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size; i &gt; index ; i--) &#123; <span class="comment">//元素依次往后挪动</span></span><br><span class="line">        elements[i] = elements[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    elements[index] = element;</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同理，其实add(E element)就是往动态数组末尾添加元素，所以可以直接调用重载方法，指定下标为末尾（size）就可以了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span>&#123;</span><br><span class="line">    add(size,element);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="remove"><a href="#remove" class="headerlink" title="remove()"></a>remove()</h3><p>移除指定位置的元素，移除指定位置的元素之后，指定位置的元素会被删除，然后指定位置后面的元素会<strong>依次往前挪动</strong>。</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99ArrayList/ArrayList%E6%95%B4%E5%90%88Java/image-20210818185906721.png"></p>
<p>注意，实际上不用硬性删除指定的元素，在Java的特性中，只要某一内存地址没有再被指向那么它就会被垃圾回收掉（视为删除），所以直接用后面的元素直接覆盖掉指定下标的元素，原来的元素的地址就没有被指向了，所以就会被删除，最后再将末尾的一个元素置为null即可。但是需要注意的是删除是先挪动前面再挪动后面，如果从后往前挪会被覆盖掉。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="type">E</span> <span class="variable">element</span> <span class="operator">=</span> elements[index];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> index; i &lt; size-<span class="number">1</span> ; i++) &#123; <span class="comment">//元素依次往前挪</span></span><br><span class="line">        elements[i] = elements[i+<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    elements[size-<span class="number">1</span>] = <span class="literal">null</span>; <span class="comment">//将数组的最后一个元素置为null</span></span><br><span class="line">    size--;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="clear"><a href="#clear" class="headerlink" title="clear()"></a>clear()</h3><p>清空动态数组，直接将所有位置置为null即可，那么之前的元素的地址就不没有被指向了，就会被删除。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        elements[i] = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    size = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="下标越界"><a href="#下标越界" class="headerlink" title="下标越界"></a>下标越界</h2><p>在上述方法传入index的时候，可能会出现index越界的情况，比如为负数或者超出上限，所以需要控制index的有效范围，并且在每次传入进行检查就可以了，错误就抛出异常。</p>
<blockquote>
<p><strong>注意</strong></p>
<p>add()和remove()、get()、set()的index范围有所区别。添加元素允许往动态数组的最后一个位置添加元素，所以index是可以访问到size的，但是删除、查询和修改都是在元素已经在动态数组中存在的基础上，所以index是不可以访问到size的，切记！！！</p>
</blockquote>
<h3 id="checkIndex"><a href="#checkIndex" class="headerlink" title="checkIndex()"></a>checkIndex()</h3><p>检查非添加时的下标index，不能小于0或者不能大于等于size（0&lt;index&lt;size）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkIndex</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index&lt;<span class="number">0</span>||index&gt;=size) indexOutOfBoundsException(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="checkIndexAdd"><a href="#checkIndexAdd" class="headerlink" title="checkIndexAdd()"></a>checkIndexAdd()</h3><p>检查添加时下标index，不能小于0或者不能大于size（0&lt;index$\leqslant$​size）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkIndexAdd</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index&lt;<span class="number">0</span>||index&gt;size) indexOutOfBoundsException(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="indexOutOfBoundsException"><a href="#indexOutOfBoundsException" class="headerlink" title="indexOutOfBoundsException()"></a>indexOutOfBoundsException()</h3><p>下标越界时抛出的自定义异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">indexOutOfBoundsException</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>(<span class="string">&quot;index=&quot;</span>+index+<span class="string">&quot;, size=&quot;</span>+size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="动态扩容"><a href="#动态扩容" class="headerlink" title="动态扩容"></a>动态扩容</h2><p>动态数组相较于传统数组的优势就是能够动态扩容，但其实底层仍然是利用数组扩容，实质就是利用新的容量的数组来装填原来的数据，这当中会涉及到很多底层的内存消耗以及资源最优化的问题，这里不讲解，主要讲解如何实现。</p>
<p>扩容也只可能会在添加元素的时候发生，并且是添加元素时的动态数组的size也就是元素个数刚好达到容量这个时候就该扩容了：</p>
<ol>
<li>判断动态数组元素个数已经达到数组容量，说明已经满了需要扩容了</li>
<li>新的数组容量为当前数组容量的1.5倍</li>
<li>以新的数组容量大小创建数组</li>
<li>旧数组依次向新的数组赋值</li>
<li>旧数组的指针指向新数组</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;</span><br><span class="line">    <span class="comment">//检查index</span></span><br><span class="line">    checkIndexAdd(index);</span><br><span class="line">    <span class="comment">//容量扩容</span></span><br><span class="line">    <span class="keyword">if</span> (size == elements.length)&#123; <span class="comment">//如果动态数组得大小已经达到数组容量（已满）</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">nowCapacity</span> <span class="operator">=</span> elements.length;                  <span class="comment">//当前动态数组容量就是数组长度</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> nowCapacity + (nowCapacity &gt;&gt; <span class="number">1</span>); <span class="comment">//扩容至当前容量得1.5倍</span></span><br><span class="line">        E[] newElements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newCapacity];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123; <span class="comment">//旧数组依次向新数组中赋值</span></span><br><span class="line">            newElements[i] = elements[i];</span><br><span class="line">        &#125;</span><br><span class="line">        elements = newElements;     <span class="comment">//elements对象指向newElements</span></span><br><span class="line">        System.out.println(nowCapacity + <span class="string">&quot;扩容至&quot;</span> + newCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size; i &gt; index ; i--) &#123; <span class="comment">//元素依次往后挪动</span></span><br><span class="line">        elements[i] = elements[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    elements[index] = element;</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们将数组扩容单独提出来（提高可维护性和可读性）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">ensureCapacity</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (size == elements.length)&#123; <span class="comment">//如果动态数组得大小已经达到数组容量（已满）</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">nowCapacity</span> <span class="operator">=</span> elements.length;                  <span class="comment">//当前动态数组容量就是数组长度</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> nowCapacity + (nowCapacity &gt;&gt; <span class="number">1</span>); <span class="comment">//扩容至当前容量得1.5倍</span></span><br><span class="line">        E[] newElements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newCapacity];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123; <span class="comment">//旧数组依次向新数组中赋值</span></span><br><span class="line">            newElements[i] = elements[i];</span><br><span class="line">        &#125;</span><br><span class="line">        elements = newElements;     <span class="comment">//elements对象指向newElements</span></span><br><span class="line">        System.out.println(nowCapacity + <span class="string">&quot;扩容至&quot;</span> + newCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//至此，动态数组扩容完毕</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>综合：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">ensureCapacity</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (size == elements.length)&#123; <span class="comment">//如果动态数组得大小已经达到数组容量（已满）</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">nowCapacity</span> <span class="operator">=</span> elements.length;                  <span class="comment">//当前动态数组容量就是数组长度</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> nowCapacity + (nowCapacity &gt;&gt; <span class="number">1</span>); <span class="comment">//扩容至当前容量得1.5倍</span></span><br><span class="line">        E[] newElements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newCapacity];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123; <span class="comment">//旧数组依次向新数组中赋值</span></span><br><span class="line">            newElements[i] = elements[i];</span><br><span class="line">        &#125;</span><br><span class="line">        elements = newElements;     <span class="comment">//elements对象指向newElements</span></span><br><span class="line">        System.out.println(nowCapacity + <span class="string">&quot;扩容至&quot;</span> + newCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;</span><br><span class="line">    checkIndexAdd(index);</span><br><span class="line">    ensureCapacity();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size; i &gt; index ; i--) &#123; <span class="comment">//元素依次往后挪动</span></span><br><span class="line">        elements[i] = elements[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    elements[index] = element;</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="缩容"><a href="#缩容" class="headerlink" title="缩容"></a>缩容</h2><p>在很多时候可能动态数组中没有使用的位置占比较多时，就可以使用缩容来节省空间。比如动态数组容量由于不断add然后扩容到了1000个，但是这个时候只用了100个来装元素，剩下的900个都没用装元素，这个时候其实是浪费的。所以可以考虑采用缩容的方式来节省空间。</p>
<p>remove</p>
<p>如果当前数组大小（元素个数）比当前容量的一半还要小并且当前容量大于默认容量时开始缩容：创建一个新的数组（大小为原容量的一半），然后旧数组依次赋值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">       checkIndex(index);</span><br><span class="line">       <span class="comment">//缩容开始</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">nowCapacity</span> <span class="operator">=</span> elements.length;  <span class="comment">//当前容量</span></span><br><span class="line">       <span class="keyword">if</span> ( size &lt;= nowCapacity&gt;&gt;<span class="number">1</span> &amp;&amp; nowCapacity&gt;DEFAULT_CAPACITY)&#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> nowCapacity&gt;&gt;<span class="number">1</span>; <span class="comment">//即nowCapacity/2</span></span><br><span class="line">           E[] newElements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newCapacity];</span><br><span class="line">           <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">               newElements[i] = elements[i];</span><br><span class="line">           &#125;</span><br><span class="line">           elements = newElements;</span><br><span class="line">           System.out.println(nowCapacity + <span class="string">&quot;缩容至&quot;</span> + newCapacity);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//缩容结束</span></span><br><span class="line">       <span class="type">E</span> <span class="variable">element</span> <span class="operator">=</span> elements[index];</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> index; i &lt; size-<span class="number">1</span> ; i++) &#123; <span class="comment">//元素依次往前挪</span></span><br><span class="line">           elements[i] = elements[i+<span class="number">1</span>];</span><br><span class="line">       &#125;</span><br><span class="line">       elements[size-<span class="number">1</span>] = <span class="literal">null</span>; <span class="comment">//将数组的最后一个元素置为null</span></span><br><span class="line">       size--;</span><br><span class="line">       <span class="keyword">return</span> element;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>即trim()：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 缩容（在动态数组中未使用的部分过大时缩容）</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">trim</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">nowCapacity</span> <span class="operator">=</span> elements.length;  <span class="comment">//当前容量</span></span><br><span class="line">       <span class="comment">//如果当前数组元素个数比当前容量的一半还要小，并且容量是大于默认容量的则开始缩容</span></span><br><span class="line">       <span class="keyword">if</span> ( size &lt;= nowCapacity&gt;&gt;<span class="number">1</span> &amp;&amp; nowCapacity&gt;DEFAULT_CAPACITY)&#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> nowCapacity&gt;&gt;<span class="number">1</span>; <span class="comment">//即nowCapacity/2</span></span><br><span class="line">           E[] newElements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newCapacity];</span><br><span class="line">           <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">               newElements[i] = elements[i];</span><br><span class="line">           &#125;</span><br><span class="line">           elements = newElements;</span><br><span class="line">           System.out.println(nowCapacity + <span class="string">&quot;缩容至&quot;</span> + newCapacity);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>remove()：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">       checkIndex(index);</span><br><span class="line">       trim();         <span class="comment">//缩容</span></span><br><span class="line">       <span class="type">E</span> <span class="variable">element</span> <span class="operator">=</span> elements[index];</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> index; i &lt; size-<span class="number">1</span> ; i++) &#123; <span class="comment">//元素依次往前挪</span></span><br><span class="line">           elements[i] = elements[i+<span class="number">1</span>];</span><br><span class="line">       &#125;</span><br><span class="line">       elements[size-<span class="number">1</span>] = <span class="literal">null</span>; <span class="comment">//将数组的最后一个元素置为null</span></span><br><span class="line">       size--;</span><br><span class="line">       <span class="keyword">return</span> element;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在解决了动态数组的大小、元素存放的数组等属性和一些基本的添加、删除、修改和查询方法后，以及对<strong>下标越界</strong>的处理和<strong>最核心的动态扩容</strong>部分解决后，一个最基本的动态数组ArrayList就大致完成了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayList</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> E[] elements;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组默认容量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_CAPACITY</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 无参构造，创建默认大小的数组</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">()</span>&#123;</span><br><span class="line">        elements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[DEFAULT_CAPACITY];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 有参构造，根据容量创建数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> capacity      自定义容量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">(<span class="type">int</span> capacity)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (capacity&lt;=<span class="number">0</span>) capacity = DEFAULT_CAPACITY; <span class="comment">//如果传入容量不为自然数，则强制为默认容量</span></span><br><span class="line">        elements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[capacity];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组大小</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>      动态数组大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组是否为空</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>      动态数组是否为空</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">isEmpty</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 下班超出范围的报错信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">indexOutOfBoundsException</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>(<span class="string">&quot;index=&quot;</span>+index+<span class="string">&quot;, size=&quot;</span>+size);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检查添加元素时候的index</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkIndexForAdd</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index&lt;<span class="number">0</span>||index&gt;size) indexOutOfBoundsException(index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检查删改查时的index</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkIndex</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index&lt;<span class="number">0</span>||index&gt;=size) indexOutOfBoundsException(index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 确保容量（如果动态数组元素大小达到当前动态数组的容量满了则扩容）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">ensureCapacity</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (size == elements.length)&#123; <span class="comment">//如果动态数组得大小已经达到数组容量（已满）</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">nowCapacity</span> <span class="operator">=</span> elements.length;                  <span class="comment">//当前动态数组容量就是数组长度</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> nowCapacity + (nowCapacity &gt;&gt; <span class="number">1</span>); <span class="comment">//扩容至当前容量得1.5倍</span></span><br><span class="line">            E[] newElements = (E[]) <span class="keyword">new</span> <span class="title class_">Object</span>[newCapacity];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123; <span class="comment">//旧数组依次向新数组中赋值</span></span><br><span class="line">                newElements[i] = elements[i];</span><br><span class="line">            &#125;</span><br><span class="line">            elements = newElements;     <span class="comment">//elements对象指向newElements</span></span><br><span class="line">            System.out.println(nowCapacity + <span class="string">&quot;扩容至&quot;</span> + newCapacity);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span>&#123;</span><br><span class="line">        add(size,element);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"><span class="comment">     *  1 2 3   4 5 6 7 8</span></span><br><span class="line"><span class="comment">     * 向指定位置添加元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (element == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;不允许添加null&quot;</span>);</span><br><span class="line">        checkIndexForAdd(index);</span><br><span class="line">        ensureCapacity();                     <span class="comment">//确保数组容量（如果容量满了则扩容）</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size; i &gt; index ; i--) &#123; <span class="comment">//元素依次往后挪动</span></span><br><span class="line">            elements[i] = elements[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        elements[index] = element;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"><span class="comment">     *  a b c 1 d e f g h</span></span><br><span class="line"><span class="comment">     * 移除指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        checkIndex(index);</span><br><span class="line">        trim();</span><br><span class="line">        <span class="type">E</span> <span class="variable">element</span> <span class="operator">=</span> elements[index];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> index; i &lt; size-<span class="number">1</span> ; i++) &#123; <span class="comment">//元素依次往前挪</span></span><br><span class="line">            elements[i] = elements[i+<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        elements[size-<span class="number">1</span>] = <span class="literal">null</span>; <span class="comment">//将数组的最后一个元素置为null</span></span><br><span class="line">        size--;</span><br><span class="line">        <span class="keyword">return</span> element;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除指定元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(E element)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> remove(indexOf(element));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 清空动态数组中的元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            elements[i] = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index      位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;</span><br><span class="line">        checkIndex(index);</span><br><span class="line">        elements[index] = element;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获得指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>          元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        checkIndex(index);</span><br><span class="line">        <span class="keyword">return</span> elements[index];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断数组是否包含该元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>           true包含，false不包含</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">contains</span><span class="params">(E element)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> indexOf(element) &gt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该元素第一次出现的下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>           下标</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (elements[i].equals(element)) <span class="keyword">return</span> i; <span class="comment">//如果element存在返回下标</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">string</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        string.append(<span class="string">&quot;ArrayList&#123;&quot;</span>);</span><br><span class="line">        string.append(<span class="string">&quot;size=&quot;</span> + size + <span class="string">&quot;, elements=[&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            string.append(elements[i]);</span><br><span class="line">            <span class="keyword">if</span> (i != size -<span class="number">1</span>) &#123; <span class="comment">//最后一个元素末尾不添加逗号</span></span><br><span class="line">                string.append(<span class="string">&quot;, &quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        string.append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">        string.append(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> string.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2023/07/19/data-structure/%E6%89%8B%E5%86%99ArrayList/ArrayList%E6%95%B4%E5%90%88Java/" data-id="clsblyudn000ew0k62hdv8vjl" data-title="利用Java来手写ArrayList" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ArrayList/" rel="tag">ArrayList</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9B%86%E5%90%88/" rel="tag">集合</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-data-structure/手写LinkedList/LinkedList整合Java" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/" class="article-date">
  <time class="dt-published" datetime="2023-07-19T07:30:39.000Z" itemprop="datePublished">2023-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/">利用Java手写LinkedList</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>和ArrayList不同的是，LinkedList是采用链表实现的，链表的特点就是每个节点存储的是value和下个节点的地址，所以不存在类似ArrayList的扩容问题，添加节点只需要一个新的节点对象然后链表末尾指向它就可以了。参考Java官方的LinkedList实现：<code>java.util.LinkedList</code>。不过Java官方使用双向链表实现。</p>
<blockquote>
<p><strong>链表和节点</strong></p>
<p>链表有n多个链表节点组成，每个节点存储的都是元素+下个节点的内存地址。如何得到节点中存储的元素实际上是通过从链表的头一个节点开始迭代，然后得到当前节点。</p>
</blockquote>
<h2 id="私有属性"><a href="#私有属性" class="headerlink" title="私有属性"></a>私有属性</h2><p>动态数组大小<code>size</code>，以及用于存放该动态数组的头节点<code>first</code></p>
<blockquote>
<p><strong>注意</strong>：为什么要有头节点？</p>
<p>是因为链表元素的获取是利用迭代来不断得到next元素的，也就是说你迭代到了中间某一元素后，你就没有办法回溯了，你这个链表就暂时停留在这里了（因为该元素前的所以链表的内存地址已丢失），所以就需要保存一个头节点的内存地址，以确保每次都能够从头开始依次访问链表中的元素</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 头节点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Node&lt;E&gt; first;</span><br><span class="line">    </span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>

<h2 id="节点类"><a href="#节点类" class="headerlink" title="节点类"></a>节点类</h2><p>通过静态内部类的方式来声明链表中的节点Node类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 头节点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Node&lt;E&gt; first;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 静态内部类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;E&gt;&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 该节点存储的元素</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> E element;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 该节点所指向的下一个节点</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> Node&lt;E&gt; next;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E element, Node&lt;E&gt; next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.element = element;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>

<p>Node类主要包含节点存储的具体元素、下个节点的内存地址，以及节点的构造方法（指定元素，以及指定下一个节点）。</p>
<h2 id="通过下标获得具体node节点"><a href="#通过下标获得具体node节点" class="headerlink" title="通过下标获得具体node节点"></a>通过下标获得具体node节点</h2><p>链表与数组不同的是，它是利用迭代来定位到具体某个节点的，再很多add、remove的场景中我们可能会经常需要定位到某个具体的节点（因为需要获取该节点前后的节点）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取具体某一下标的节点</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> index      下标</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span>           该下标的node节点</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">private</span> Node&lt;E&gt; <span class="title function_">node</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">       Node&lt;E&gt; node = first;</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">           node = node.next;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> node;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>可以看到上述方法就是通过for循环的方式，node.next不断迭代获得node节点，最后获取到位于index位置的node元素。</p>
<h2 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h2><p>LinkedList不同于ArrayList，因为它不需要初始化数组容量，所以它没有构造函数。</p>
<h2 id="基本方法"><a href="#基本方法" class="headerlink" title="基本方法"></a>基本方法</h2><p>和ArrayList类似，LinkedList具有以下基本方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组大小</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>      动态数组大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组是否为空</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>      动态数组是否为空</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">isEmpty</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"><span class="comment">     *  1 2 3   4 5 6 7 8</span></span><br><span class="line"><span class="comment">     * 向指定位置添加元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"><span class="comment">     *  a b c 1 d e f g h</span></span><br><span class="line"><span class="comment">     * 移除指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除指定元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 清空动态数组中的元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index      位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> index,E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获得指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>          元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断数组是否包含该元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>           true包含，false不包含</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">contains</span><span class="params">(E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该元素第一次出现的下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>           下标</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="size"><a href="#size" class="headerlink" title="size()"></a>size()</h3><p>返回动态数组的大小</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="keyword">return</span> size; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="isEmpty"><a href="#isEmpty" class="headerlink" title="isEmpty()"></a>isEmpty()</h3><p>返回该动态数组是否为空，即判断size是否为0</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="keyword">return</span> size == <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString()"></a>toString()</h3><p>打印该链表，依旧是从头节点开始迭代然后打印</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">StringBuilder</span> <span class="variable">string</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">       string.append(<span class="string">&quot;LinkedList&#123;&quot;</span>);</span><br><span class="line">       string.append(<span class="string">&quot;size=&quot;</span> + size + <span class="string">&quot;, elements=[&quot;</span>);</span><br><span class="line">       Node&lt;E&gt; node = first;</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">           string.append(node.element);</span><br><span class="line">           node = node.next;</span><br><span class="line">           <span class="keyword">if</span> (i!=size-<span class="number">1</span>)&#123;</span><br><span class="line">               string.append(<span class="string">&quot;, &quot;</span>);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       string.append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">       string.append(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">       <span class="keyword">return</span> string.toString();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="indexOf-和contains"><a href="#indexOf-和contains" class="headerlink" title="indexOf()和contains()"></a>indexOf()和contains()</h3><p>indexOf(E element)就是返回该元素所在的位置下标，如果不存在则返回-1。同样地，利用从first开始迭代node，如果节点的元素等于传入的元素则直接返回该下标。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span> &#123;</span><br><span class="line">    Node&lt;E&gt; node = first;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (node.element).equals(element) ) <span class="keyword">return</span> i;</span><br><span class="line">        node = node.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>contains(E element)就是判断链表是否包含该元素，如果包含则返回true。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E element)</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> indexOf(element) &gt;= <span class="number">0</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="get"><a href="#get" class="headerlink" title="get()"></a>get()</h3><p>通过节点下标获得该节点</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> node(index).element;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="set"><a href="#set" class="headerlink" title="set()"></a>set()</h3><p>修改某位置节点的元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">       node(index).element = element;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="add"><a href="#add" class="headerlink" title="add()"></a>add()</h3><p>链表添加元素。链表添加元素的原理大致是：</p>
<ol>
<li>获取该下标位置的前一个节点（目的是拿到该下标位置的地址）</li>
<li>创建一个新的Node节点，将当前位置的地址赋值给该Node节点，同时插入的元素也赋值给该节点</li>
<li>前一个节点next指向新创建的Node节点。</li>
<li>这样原先的前一个节点的next指向新创建的节点，新创建的节点指向原本该下标的节点，这样就完成了插入。最后size++</li>
</ol>
<p>步骤图：</p>
<ol>
<li><p>原链表</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210827171700166.png"></p>
</li>
<li><p>执行插入</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210827172218050.png"></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>)&#123;</span><br><span class="line">            first = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, first);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;E&gt; pNode = node(index - <span class="number">1</span>);             <span class="comment">//当前index的前一个节点</span></span><br><span class="line">            pNode.next = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, pNode.next);      <span class="comment">//当前节点的下一个节点赋给待添加的节点</span></span><br><span class="line">        &#125;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>需要特别注意的就是，如果向第一个位置进行插入，那么利用上述的<code>node(int index)</code>方法是没有办法获取到头节点的前一个节点的（因为不存在）。所以如果是往index为0的位置插入需要额外写方法。逻辑就是直接将first指向新创建的node节点就可以了，同时将原有的first指向存入新创建的node节点。</p>
<h3 id="remove"><a href="#remove" class="headerlink" title="remove()"></a>remove()</h3><p>链表移除元素。原理同样是改变元素指向：</p>
<ol>
<li>获取到移除元素的前一个节点，命名为pNode</li>
<li>将要移除元素的next赋值给pNode.next</li>
<li>这样pNode直接指向要移除元素的下一个元素。最后size–</li>
</ol>
<p>步骤图：</p>
<ol>
<li><p>原链表</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210827181900189.png"></p>
</li>
<li><p>执行删除</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210827181930981.png"></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">       Node&lt;E&gt; indexNode = <span class="literal">null</span>;</span><br><span class="line">       <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">           indexNode = first;</span><br><span class="line">           first = first.next;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           Node&lt;E&gt; pNode = node(index - <span class="number">1</span>);</span><br><span class="line">           indexNode = pNode.next;</span><br><span class="line">           pNode.next = indexNode.next;</span><br><span class="line">       &#125;</span><br><span class="line">       size--;</span><br><span class="line">       <span class="keyword">return</span> indexNode;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>pNode直接指向当前node.next后，当前node没有被指向了，那么它就会被Java的垃圾回收机制给自动清理掉。同样需要注意的是，如果需要删除第一个元素，你同样也是没办法获取到first的。所以也是需要额外处理，直接将当前的first指向first.next，那么原来first指向的节点也会被Java垃圾回收机制给清理掉。</p>
<h3 id="clear"><a href="#clear" class="headerlink" title="clear()"></a>clear()</h3><p>清空数组的所有元素，直接置size为0，并且first指向null就可以了，因为first指向null，所以first以及first后面所指向的所有节点都会被销毁。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">       size = <span class="number">0</span>;</span><br><span class="line">       first = <span class="literal">null</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h2 id="下标越界"><a href="#下标越界" class="headerlink" title="下标越界"></a>下标越界</h2><p>和ArrayList同样的，在执行add或者remove前都需要检查一下传入的index是否在范围内。</p>
<blockquote>
<p><strong>注意</strong></p>
<p>add()和remove()、get()、set()的index范围有所区别。添加元素允许往动态数组的最后一个位置添加元素，所以index是可以访问到size的，但是删除、查询和修改都是在元素已经在动态数组中存在的基础上，所以index是不可以访问到size的，切记！！！</p>
</blockquote>
<h3 id="checkIndex"><a href="#checkIndex" class="headerlink" title="checkIndex()"></a>checkIndex()</h3><p>检查非添加时的下标index，不能小于0或者不能大于等于size（0&lt;index&lt;size）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkIndex</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index&lt;<span class="number">0</span>||index&gt;=size) indexOutOfBoundsException(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="checkIndexAdd"><a href="#checkIndexAdd" class="headerlink" title="checkIndexAdd()"></a>checkIndexAdd()</h3><p>检查添加时下标index，不能小于0或者不能大于size（0&lt;index$\leqslant$size）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkIndexAdd</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index&lt;<span class="number">0</span>||index&gt;size) indexOutOfBoundsException(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="indexOutOfBoundsException"><a href="#indexOutOfBoundsException" class="headerlink" title="indexOutOfBoundsException()"></a>indexOutOfBoundsException()</h3><p>下标越界时抛出的自定义异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">indexOutOfBoundsException</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>(<span class="string">&quot;index=&quot;</span>+index+<span class="string">&quot;, size=&quot;</span>+size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="List接口"><a href="#List接口" class="headerlink" title="List接口"></a>List接口</h2><p>在很多时候一种思想可以用不同的解决办法来实现，比如动态数组就可以利用底层分别是数组和链表的ArrayList和LinkedList来实现，他们需要实现的方法是一样的，但是方法内部的实现是不一样的，所以就可以为他们共同指定一个<strong>“标准”</strong>，这个标准就是<strong>接口</strong>。接口里只定义需要实现的方法（返回值类型、传入的参数、方法名），接口不需要关心方法如何具体实现，只需要指定方法就可以了，这样不同的解决方法就可以有不同的具体实现，虽然是实现同一个方法。就类似公司领导给两个人下达了同一任务，只告诉了这个任务需要什么，并且要得到什么，但是他不关心具体实现过程，由员工来按照要求进行实现。不同员工实现该任务肯定各有优劣，领导就会根据他想要的目的来选用哪个具体的解决方案。</p>
<p>那么List接口应该有如下方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">List</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组大小</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>      动态数组大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态数组是否为空</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>      动态数组是否为空</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"><span class="comment">     *  1 2 3   4 5 6 7 8</span></span><br><span class="line"><span class="comment">     * 向指定位置添加元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index,E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line"><span class="comment">     *  a b c 1 d e f g h</span></span><br><span class="line"><span class="comment">     * 移除指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除指定元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element   元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    E <span class="title function_">remove</span><span class="params">(E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 清空动态数组中的元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index      位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> index,E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获得指定位置的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>          元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断数组是否包含该元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>           true包含，false不包含</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E element)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该元素第一次出现的下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element    元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>           下标</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="AbstractList抽象类"><a href="#AbstractList抽象类" class="headerlink" title="AbstractList抽象类"></a>AbstractList抽象类</h2><p>如果说接口是严格的标准，那么抽象类就是宽松一点的标准，抽象类里可以实现接口，甚至可以预先实现部分方法。通常抽象类实现接口后可以将可能会用到的重复代码或者方法或者属性抽离到抽象类中。</p>
<p>比如ArrayList和LinkedList都需要用到获取动态数组大小和判断动态数组是否为空，那么就可以将这两个方法抽离出来，以及判断index下标是否越界也是可以抽离的。那么AbstractList抽象类如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractList</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * list大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123; <span class="keyword">return</span> size; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123; <span class="keyword">return</span> size == <span class="number">0</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * index超出范围后的报错信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">indexOutOfBoundsException</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>(<span class="string">&quot;index=&quot;</span>+index+<span class="string">&quot;, size=&quot;</span>+size);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检查删改查元素的index</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">checkIndex</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index&lt;<span class="number">0</span> || index&gt;=size) indexOutOfBoundsException(index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检查增元素的index</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">checkIndexForAdd</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index&lt;<span class="number">0</span> || index&gt;size) indexOutOfBoundsException(index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要特别注意方法和属性的访问范围限制，protected是当前类和子类都能访问，private是只能当前类访问。</p>
<p>所以List接口、AbstractList抽象类、ArrayList和LinkedList类的继承关系如下：</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210830121133007.png"></p>
<h2 id="内存或时间消耗"><a href="#内存或时间消耗" class="headerlink" title="内存或时间消耗"></a>内存或时间消耗</h2><p>ArrayList底层就是数组，数组的存储空间是一串连续的内存地址，是比较省空间的。在add或者remove中间的元素需要不断移动后面的元素，存储空间存储的内存地址不断被重新赋值。往数组末尾添加或者删除元素的时直接加在数组尾或者移除数组尾元素，是不需要移动任何元素的。扩容的时候需要请求内存并且重新循环给数组赋值。如果数组没有被元素填满的话，可能存在浪费。</p>
<p>LinkedList底层是链表，每个节点存储的是元素和下一个节点的内存地址，内存地址是散乱的，在add或者remove的时候只需要改变节点存储的下一个节点的指向就可以了，比较方便，并且不需要扩容，即加一个元素就直接加一个元素，移除一个元素就移除一个元素。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractList</span>&lt;E&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 头节点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Node&lt;E&gt; first;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 静态内部类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;E&gt;&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 该节点存储的元素</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> E element;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 该节点所指向的下一个节点</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> Node&lt;E&gt; next;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E element, Node&lt;E&gt; next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.element = element;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取具体某一下标的节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index      下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>           该下标的node节点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Node&lt;E&gt; <span class="title function_">node</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        Node&lt;E&gt; node = first;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">            node = node.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        add(size,element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        checkIndexForAdd(index);</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>)&#123;</span><br><span class="line">            first = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, first);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;E&gt; pNode = node(index - <span class="number">1</span>);             <span class="comment">//当前index的前一个节点</span></span><br><span class="line">            pNode.next = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, pNode.next);      <span class="comment">//当前节点的下一个节点赋给待添加的节点</span></span><br><span class="line">        &#125;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        checkIndex(index);</span><br><span class="line">        Node&lt;E&gt; indexNode = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">            indexNode = first;</span><br><span class="line">            first = first.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;E&gt; pNode = node(index - <span class="number">1</span>);</span><br><span class="line">            indexNode = pNode.next;</span><br><span class="line">            pNode.next = indexNode.next;</span><br><span class="line">        &#125;</span><br><span class="line">        size--;</span><br><span class="line">        <span class="keyword">return</span> indexNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> remove(indexOf(element));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">        first = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">        checkIndex(index);</span><br><span class="line">        node(index).element = element;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        checkIndex(index);</span><br><span class="line">        <span class="keyword">return</span> node(index).element;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> indexOf(element) &gt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(E element)</span> &#123;</span><br><span class="line">        Node&lt;E&gt; node = first;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ( (node.element).equals(element) ) <span class="keyword">return</span> i;</span><br><span class="line">            node = node.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">string</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        string.append(<span class="string">&quot;LinkedList&#123;&quot;</span>);</span><br><span class="line">        string.append(<span class="string">&quot;size=&quot;</span> + size + <span class="string">&quot;, elements=[&quot;</span>);</span><br><span class="line">        Node&lt;E&gt; node = first;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            string.append(node.element);</span><br><span class="line">            node = node.next;</span><br><span class="line">            <span class="keyword">if</span> (i!=size-<span class="number">1</span>)&#123;</span><br><span class="line">                string.append(<span class="string">&quot;, &quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        string.append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">        string.append(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> string.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="虚拟头节点"><a href="#虚拟头节点" class="headerlink" title="虚拟头节点"></a>虚拟头节点</h2><p>在add以及remove的时候，常常需要判断index是否为0，其实这个时候可以引入虚拟头节点的方式来保证每个节点的前一个节点都是存在的。</p>
<p>即在构造方法中，创建LinkedList对象时候就创建一个虚拟头节点：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">LinkedList2</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="comment">//虚拟头节点</span></span><br><span class="line">       first = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;E&gt;(<span class="literal">null</span>,<span class="literal">null</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>同样的，使用index来查找链表中节点的时候，如果index为-1，则返回这个头节点，其余时候正常返回：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Node&lt;E&gt; <span class="title function_">node</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">       Node&lt;E&gt; node = first.next;</span><br><span class="line">       <span class="keyword">if</span> (index == -<span class="number">1</span>) <span class="keyword">return</span> first;</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">           node = node.next;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> node;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>那么在add或者remove的时候就可以直接获取前一个节点就可以了，即使是index为0的时候，因为index为0时，它的前结点是index为-1的虚拟头节点：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">       checkIndex(index);</span><br><span class="line">       Node&lt;E&gt; preNode = node(index - <span class="number">1</span>);</span><br><span class="line">       preNode.next = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element,preNode.next);</span><br><span class="line">       size++;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">       checkIndex(index);</span><br><span class="line">       Node&lt;E&gt; preNode = node(index - <span class="number">1</span>);</span><br><span class="line">       Node&lt;E&gt; indexNode = preNode.next;</span><br><span class="line">       preNode.next = indexNode.next;</span><br><span class="line">       size--;</span><br><span class="line">       <span class="keyword">return</span> indexNode;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h2 id="双向链表"><a href="#双向链表" class="headerlink" title="双向链表"></a>双向链表</h2><p>双向链表会在单向链表的基础上增加尾节点的概念，以及节点Node上会多一个前一个节点的内存地址。目的就是为了增加从尾节点开始迭代访问节点的效率。</p>
<blockquote>
<p><strong>与单向链表的差别</strong></p>
<p>单向链表每次访问index位置的元素都是从first开始访问，但是如果链表存储的元素过多，需要访问比较靠后的元素花费的时间就比较长，此时引入双向链表的概念（即last开始访问）。将链表中元素根据size分为前半部分和后半部分，如果index靠近前半部分就从first开始迭代，反之则从last开始迭代。同时node节点中需要使用prev来引用前一个节点的地址。所以其实双向链表是对称的。</p>
</blockquote>
<p>它的结构如图：<img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916160017658.png"></p>
<p>first指向首节点，last指向尾节点</p>
<p>那么它的私有属性以及内部类则就是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractList</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//首节点</span></span><br><span class="line">    <span class="keyword">private</span> Node&lt;E&gt; first;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//尾节点</span></span><br><span class="line">    <span class="keyword">private</span> Node&lt;E&gt; last;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//节点</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;E&gt;&#123;</span><br><span class="line">        <span class="keyword">private</span> E element;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;E&gt; prev;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;E&gt; next;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E element, Node&lt;E&gt; prev, Node&lt;E&gt; next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.element = element;</span><br><span class="line">            <span class="built_in">this</span>.prev = prev;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>则它根据index获取对应位置的节点的方法就是：</p>
<p>index与一半size进行比较，如果index位于前半部分则从first开始迭代，反正则从last开始迭代。（提高了时间效率，不再像单向链表一样每次都从前往后迭代访问）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 双向链表可以根据index距离头节点更近或者尾节点更近来选择从那边开始迭代</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index     下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>          node节点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">private</span> Node&lt;E&gt; <span class="title function_">node</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">halfSize</span> <span class="operator">=</span> size &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (index&lt;=halfSize) &#123;<span class="comment">//如果要访问的下标在前一半链表</span></span><br><span class="line">        Node&lt;E&gt; node = first;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">            node = node.next;   <span class="comment">//依次往后迭代</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;<span class="comment">//如果要访问的下标在后一半链表</span></span><br><span class="line">        Node&lt;E&gt; node = last;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size-<span class="number">1</span>; i &gt; index ; i--) &#123;</span><br><span class="line">            node = node.prev;   <span class="comment">//依次往前迭代</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="add-1"><a href="#add-1" class="headerlink" title="add"></a>add</h3><p>与单向链表会有一些差别，因为涉及到prev引用。</p>
<h4 id="普遍情况（size-1并且不是往首或尾添加）"><a href="#普遍情况（size-1并且不是往首或尾添加）" class="headerlink" title="普遍情况（size &gt; 1并且不是往首或尾添加）"></a>普遍情况（size &gt; 1并且不是往首或尾添加）</h4><ol>
<li><p>获取到当前index位置的节点（命名nextNode）以及它的前一个位置的节点（命名prevNode）</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916162609681.png"></p>
</li>
<li><p>创建一个Node对象，它的prev指向prevNode，它的next指向nextNode</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916162816569.png"></p>
</li>
<li><p>prevNode的next指向新创建的Node对象，nextNode的prev指向新创建的Node对象，完成add操作</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916162903772.png"></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Node&lt;E&gt; nextNode = node(index);<span class="comment">//index位置的节点</span></span><br><span class="line">Node&lt;E&gt; prevNode = nextNode.prev;<span class="comment">//index位置的前节点</span></span><br><span class="line">Node&lt;E&gt; node = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, prevNode, nextNode);<span class="comment">//新加入的节点</span></span><br><span class="line">prevNode.next = node;</span><br><span class="line">nextNode.prev = node;</span><br></pre></td></tr></table></figure>



<h4 id="空链表的情况（size-0）"><a href="#空链表的情况（size-0）" class="headerlink" title="空链表的情况（size &#x3D; 0）"></a>空链表的情况（size &#x3D; 0）</h4><p>直接创建一个节点，该节点的prev和next都为null，然后链表的first和last都指向该节点</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Node&lt;E&gt; node = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">first = node;</span><br><span class="line">last = node;</span><br></pre></td></tr></table></figure>



<h4 id="向首位置插入（index-0-且-size-0）"><a href="#向首位置插入（index-0-且-size-0）" class="headerlink" title="向首位置插入（index &#x3D; 0 且 size &gt; 0）"></a>向首位置插入（index &#x3D; 0 且 size &gt; 0）</h4><p>（如果size为0往首位置插入实际上就是往空链表插入所以和上面的情况没差别则不讨论）</p>
<ol>
<li><p>首先获取到插入前的首节点，即first（命名为oldFirst）</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916163630499.png"></p>
</li>
<li><p>创建新的节点node，它的next指向oldFirst，prev指向null</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916163736932.png"></p>
</li>
<li><p>first指向新的节点node，之前的oldFirst的prev指向新的节点，完成add操作</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916164001023.png"></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Node&lt;E&gt; oldFirst = first;	<span class="comment">//获取first节点</span></span><br><span class="line">Node&lt;E&gt; node = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, <span class="literal">null</span>, oldFirst);</span><br><span class="line">first = node;</span><br><span class="line">oldFirst.prev = node;</span><br></pre></td></tr></table></figure>



<h4 id="向尾位置插入（index-size且size-0）"><a href="#向尾位置插入（index-size且size-0）" class="headerlink" title="向尾位置插入（index &#x3D; size且size&gt;0）"></a>向尾位置插入（index &#x3D; size且size&gt;0）</h4><p>和向首位置插入基本类似，对称的。</p>
<ol>
<li><p>获取原本的尾节点oldLast</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916164456330.png"></p>
</li>
<li><p>创建新的节点node，它的prev指向oldLast，next指向null</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916164540759.png"></p>
</li>
<li><p>链表的last指向新创建node节点，oldLast的next也指向新创建的node节点，完成add操作</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916164631987.png"></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Node&lt;E&gt; oldLast = last; <span class="comment">//原本的最后一个元素</span></span><br><span class="line">Node&lt;E&gt; node = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, oldLast, <span class="literal">null</span>);</span><br><span class="line">last = node;</span><br><span class="line">oldLast.next = node;</span><br></pre></td></tr></table></figure>

<h4 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">    checkIndexForAdd(index);</span><br><span class="line">    <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;    <span class="comment">//链表中还没有任何元素（即即将添加的是第一个元素）</span></span><br><span class="line">        Node&lt;E&gt; node = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        first = node;</span><br><span class="line">        last = node;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;    <span class="comment">//链表中已经存在至少一个元素</span></span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;   <span class="comment">//往第一个位置添加元素</span></span><br><span class="line">            Node&lt;E&gt; oldFirst = first;</span><br><span class="line">            Node&lt;E&gt; node = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, <span class="literal">null</span>, oldFirst);</span><br><span class="line">            first = node;</span><br><span class="line">            oldFirst.prev = node;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size)&#123;  <span class="comment">//往最后一个位置添加元素</span></span><br><span class="line">            Node&lt;E&gt; oldLast = last; <span class="comment">//原本的最后一个元素</span></span><br><span class="line">            Node&lt;E&gt; node = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, oldLast, <span class="literal">null</span>);</span><br><span class="line">            last = node;</span><br><span class="line">            oldLast.next = node;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;    <span class="comment">//往中间添加元素</span></span><br><span class="line">            Node&lt;E&gt; nextNode = node(index);<span class="comment">//index位置的节点</span></span><br><span class="line">            Node&lt;E&gt; prevNode = nextNode.prev;<span class="comment">//index位置的前节点</span></span><br><span class="line">            Node&lt;E&gt; node = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(element, prevNode, nextNode);<span class="comment">//新加入的节点</span></span><br><span class="line">            prevNode.next = node;</span><br><span class="line">            nextNode.prev = node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="remove-1"><a href="#remove-1" class="headerlink" title="remove"></a>remove</h3><p>remove移除节点考虑的和add差不太多，主要也是考虑没有节点时候的删除以及删除首或者尾节点</p>
<h4 id="普遍情况（size-1-且不是从首或尾移除）"><a href="#普遍情况（size-1-且不是从首或尾移除）" class="headerlink" title="普遍情况（size &gt; 1 且不是从首或尾移除）"></a>普遍情况（size &gt; 1 且不是从首或尾移除）</h4><ol>
<li><p>获取到当前index位置节点（indexNode）的前一个节点（prevNode）以及它的后一个节点（nextNode）</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916165410816.png"></p>
</li>
<li><p>prevNode的next指向nextNode，nextNode的prev指向prevNode（此时indexNode没有被引用，根据Java垃圾回收机制就会被清空），remove操作完成</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916165457243.png"></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Node&lt;E&gt; indexNode = node(index);    <span class="comment">//当前index的节点</span></span><br><span class="line">Node&lt;E&gt; prevNode = indexNode.prev;  <span class="comment">//当前index的前一节点</span></span><br><span class="line">Node&lt;E&gt; nextNode = indexNode.next;  <span class="comment">//当前index的后一节点</span></span><br><span class="line">prevNode.next = nextNode;</span><br><span class="line">nextNode.prev = prevNode;</span><br></pre></td></tr></table></figure>

<h4 id="链表中只有一个元素（size-1）"><a href="#链表中只有一个元素（size-1）" class="headerlink" title="链表中只有一个元素（size &#x3D; 1）"></a>链表中只有一个元素（size &#x3D; 1）</h4><p>直接first和last都指向null</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">first = <span class="literal">null</span>;</span><br><span class="line">last = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>

<h4 id="移除首节点（size-1-且-index-0）"><a href="#移除首节点（size-1-且-index-0）" class="headerlink" title="移除首节点（size &gt; 1 且 index &#x3D; 0）"></a>移除首节点（size &gt; 1 且 index &#x3D; 0）</h4><ol>
<li><p>获取到首节点first，以及首节点的下一个节点first.next</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916170144977.png"></p>
</li>
<li><p>first.next的prev指向null，然后链表的first指向first.next（此时之前的first节点没有被指向了，就会被垃圾回收掉），此时remove操作完成</p>
<p><img src="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/image-20210916170429403.png"></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">first.next.prev = <span class="literal">null</span>;</span><br><span class="line">first = first.next;</span><br></pre></td></tr></table></figure>



<h4 id="移除尾节点（size-1-且-index-size-1-）"><a href="#移除尾节点（size-1-且-index-size-1-）" class="headerlink" title="移除尾节点（size &gt; 1 且 index &#x3D; size -1 ）"></a>移除尾节点（size &gt; 1 且 index &#x3D; size -1 ）</h4><p>移除尾节点和移除首节点类似，只是first换为last，并且prev换位next</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">last.prev.next = <span class="literal">null</span>;</span><br><span class="line">last = last.prev;</span><br></pre></td></tr></table></figure>

<h4 id="合并-1"><a href="#合并-1" class="headerlink" title="合并"></a>合并</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">       checkIndex(index);</span><br><span class="line">       Node&lt;E&gt; indexNode = <span class="literal">null</span>;</span><br><span class="line">       <span class="keyword">if</span> (size == <span class="number">1</span>) &#123;    <span class="comment">//只有一个元素的时候</span></span><br><span class="line">           indexNode = first;</span><br><span class="line">           first = <span class="literal">null</span>;</span><br><span class="line">           last = <span class="literal">null</span>;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;    <span class="comment">//至少两个元素</span></span><br><span class="line">           <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;  <span class="comment">//移除第一个元素</span></span><br><span class="line">               indexNode = first;</span><br><span class="line">               first.next.prev = <span class="literal">null</span>;</span><br><span class="line">               first = first.next;</span><br><span class="line">           &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == size -<span class="number">1</span>) &#123;  <span class="comment">//移除最后一个元素</span></span><br><span class="line">               indexNode = last;</span><br><span class="line">               last.prev.next = <span class="literal">null</span>;</span><br><span class="line">               last = last.prev;</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               indexNode = node(index);            <span class="comment">//当前index的节点</span></span><br><span class="line">               Node&lt;E&gt; prevNode = indexNode.prev;  <span class="comment">//当前index的前一节点</span></span><br><span class="line">               Node&lt;E&gt; nextNode = indexNode.next;  <span class="comment">//当前index的后一节点</span></span><br><span class="line">               prevNode.next = nextNode;</span><br><span class="line">               nextNode.prev = prevNode;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       size--;</span><br><span class="line">       <span class="keyword">return</span> indexNode.element;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h3 id="clear-1"><a href="#clear-1" class="headerlink" title="clear"></a>clear</h3><p>即first和last都指向null，并且size &#x3D; 0</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">    size = <span class="number">0</span>;</span><br><span class="line">    first = <span class="literal">null</span>;</span><br><span class="line">    last = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="lastIndexOf"><a href="#lastIndexOf" class="headerlink" title="lastIndexOf"></a>lastIndexOf</h3><p>增加了可以从链表尾部开始查找</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">lastIndexOf</span><span class="params">(E element)</span> &#123;</span><br><span class="line">    Node&lt;E&gt; node = last;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (node.element).equals(element) ) <span class="keyword">return</span> i;</span><br><span class="line">        node = node.prev;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="单向链表和双向链表的区别"><a href="#单向链表和双向链表的区别" class="headerlink" title="单向链表和双向链表的区别"></a>单向链表和双向链表的区别</h2><p>双向链表引入了尾节点，可以从尾节点开始迭代访问节点元素，在一定程度上增加了效率，并且通过index与size&#x2F;2进行比较，决定是从哪边开始访问。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/" data-id="clsblyudo000fw0k6aojzci5a" data-title="利用Java手写LinkedList" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LinkedList/" rel="tag">LinkedList</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9B%86%E5%90%88/" rel="tag">集合</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-back-end/DevOps/CI_CD" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/19/back-end/DevOps/CI_CD/" class="article-date">
  <time class="dt-published" datetime="2023-07-19T07:30:39.000Z" itemprop="datePublished">2023-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/19/back-end/DevOps/CI_CD/">CI_CD</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="DevOps"><a href="#DevOps" class="headerlink" title="DevOps"></a>DevOps</h2><p><img src="/2023/07/19/back-end/DevOps/CI_CD/image-20220419170621946.png"></p>
<h2 id="CI"><a href="#CI" class="headerlink" title="CI"></a>CI</h2><p><strong>Continuous Integration</strong>，持续集成</p>
<p><img src="/2023/07/19/back-end/DevOps/CI_CD/image-20220420154045759.png"></p>
<h2 id="CD"><a href="#CD" class="headerlink" title="CD"></a>CD</h2><p><strong>Continuous Delivery</strong>，持续交付</p>
<p><strong>Continuous Deployment</strong>，持续部署</p>
<p><img src="/2023/07/19/back-end/DevOps/CI_CD/image-20220420154129435.png"></p>
<h2 id="GitLab-CI-CD"><a href="#GitLab-CI-CD" class="headerlink" title="GitLab CI&#x2F;CD"></a>GitLab CI&#x2F;CD</h2><ol>
<li>注册Runner并且为代码仓库配置<code>gitlab-runner</code>服务，它是用来实际执行CI任务的服务器；</li>
<li>提交代码的时候，确保根目录有一个文件名为<code>.gitlab-ci.yml</code>的文件，该文件是用来指定CI流程（如：build、test、deploy），指定某流程触发时候的脚本（script）</li>
<li>GitLab对根目录有文件名为<code>.gitlab-ci.yml</code>的代码进行检测，如果当前提交符合文件中的指定出发条件，则会分配对应的<code>gitlab-runner</code>进行CI的某一流程。</li>
<li>若该次CI流程中的某个脚本运行失败，则判定此次CI不通过，需要提交者修复问题再次提交，直至CI通过。</li>
</ol>
<h3 id="gitlab-ci-yaml文件编写"><a href="#gitlab-ci-yaml文件编写" class="headerlink" title=".gitlab-ci.yaml文件编写"></a>.gitlab-ci.yaml文件编写</h3><p><img src="/2023/07/19/back-end/DevOps/CI_CD/image-20220420165831888.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2023/07/19/back-end/DevOps/CI_CD/" data-id="clsblyuds000hw0k605bdavxj" data-title="CI_CD" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/devops/" rel="tag">devops</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-design-pattern/SOLID/面向对象的S.O.L.I.D原则" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/19/design-pattern/SOLID/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84S.O.L.I.D%E5%8E%9F%E5%88%99/" class="article-date">
  <time class="dt-published" datetime="2023-07-19T07:30:39.000Z" itemprop="datePublished">2023-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/19/design-pattern/SOLID/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84S.O.L.I.D%E5%8E%9F%E5%88%99/">面向对象的S.O.L.I.D原则</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Single-responsibility-principle"><a href="#Single-responsibility-principle" class="headerlink" title="Single responsibility principle"></a>Single responsibility principle</h2><p><strong>单一职责原则</strong>：改变类的原因不应该超过一个，即一个类应该只有一个职责。</p>
<p>实例：面积计算器</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> AreaCalculate <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a AreaCalculate)</span></span> Calculate(p Plane) <span class="type">float64</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> p.Area()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述名为<code>AreaCalculate</code>的类最好只进行一项功能：计算面积。而不是：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> AreaCalculate <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a AreaCalculate)</span></span> Calculate(p Plane) <span class="type">float64</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> p.Area()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a AreaCalculate)</span></span> PrintAreaAsJSON() &#123;</span><br><span class="line">	<span class="comment">// print as JSON</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a AreaCalculate)</span></span> PrintAreaAsXML() &#123;</span><br><span class="line">	<span class="comment">// print as XML</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a AreaCalculate)</span></span> PrintAreaAsStdin() &#123;</span><br><span class="line">	<span class="comment">// print as Stdin</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>错误示范：上述类不仅要计算面积，还有按照需求对面积进行相应的格式化输出，这就违反的了单一职责原则：<strong>一个类应该只有一个职责</strong>。正确的做法应该是再有另外一个类：对面积进行格式化（JSON、XML、Stdin等）输出。这样就有了两个类：计算面积的类，对计算出来的面积进行格式化打印的类。</p>
<h2 id="Open-close-principle"><a href="#Open-close-principle" class="headerlink" title="Open-close principle"></a>Open-close principle</h2><p><strong>开放封闭原则</strong>：对象或者实体应该对扩展开放，对修改封闭。</p>
<h2 id="Liskov-substitution-principle"><a href="#Liskov-substitution-principle" class="headerlink" title="Liskov substitution principle"></a>Liskov substitution principle</h2><p><strong>里氏替换原则</strong>：任何子类或者派生类应该可以替换它的基类或者父类。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Human <span class="keyword">struct</span> &#123;</span><br><span class="line">	skin   <span class="type">string</span></span><br><span class="line">	gender <span class="type">string</span></span><br><span class="line">	height <span class="type">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h Human)</span></span> Skin() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> h.skin</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h Human)</span></span> Gender() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> h.gender</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h Human)</span></span> Height() <span class="type">float64</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> h.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Man <span class="keyword">struct</span> &#123;</span><br><span class="line">	Human</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m Man)</span></span> Skin() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> m.skin</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m Man)</span></span> Gender() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;男&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m Man)</span></span> Height() <span class="type">float64</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> m.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Woman <span class="keyword">struct</span> &#123;</span><br><span class="line">	Human</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w Woman)</span></span> Skin() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> w.skin</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w Woman)</span></span> Gender() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;女&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w Woman)</span></span> Height() <span class="type">float64</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> w.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Robot <span class="keyword">struct</span> &#123;</span><br><span class="line">	Human</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果你的设计将<code>Robot</code>类继承了<code>Human</code>类，这显然是不符合<strong>里氏替换原则</strong>的：因为<code>Robot</code>类没有办法替换它的父类<code>Human</code>。</p>
<h2 id="Interface-segregation-principle"><a href="#Interface-segregation-principle" class="headerlink" title="Interface segregation principle"></a>Interface segregation principle</h2><p><strong>接口隔离原则</strong>：不应该强迫client实现它并不需要的接口。</p>
<h2 id="Dependency-inversion-principle"><a href="#Dependency-inversion-principle" class="headerlink" title="Dependency inversion principle"></a>Dependency inversion principle</h2><p><strong>依赖倒置原则</strong>：抽象不应该依赖于具体实现，具体实现应该依赖于抽象，即High-level的实体不应该依赖于Low-level的实体，也是依赖于抽象，而不依赖于具象。</p>
<p>比如在单一职责原则中提到的，面积计算器不应该依赖于具体的图形（Triangle或者Rectangle），而是依赖于抽象的图形（Plane）。因为抽象是具有具体图形的相同属性的集合，所以依赖于广泛的抽象，就能向下兼容具体的具象。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2023/07/19/design-pattern/SOLID/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84S.O.L.I.D%E5%8E%9F%E5%88%99/" data-id="clsblyudt000iw0k6cicff7x9" data-title="面向对象的S.O.L.I.D原则" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-design-pattern/design-pattern/结合Java和Golang学习设计模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/19/design-pattern/design-pattern/%E7%BB%93%E5%90%88Java%E5%92%8CGolang%E5%AD%A6%E4%B9%A0%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2023-07-19T07:30:39.000Z" itemprop="datePublished">2023-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/19/design-pattern/design-pattern/%E7%BB%93%E5%90%88Java%E5%92%8CGolang%E5%AD%A6%E4%B9%A0%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">结合Java和Golang学习设计模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="设计模式是什么？"><a href="#设计模式是什么？" class="headerlink" title="设计模式是什么？"></a>设计模式是什么？</h2><p>设计模式是软件设计中常见问题的<strong>典型</strong>解决方案。它们就像能根据需求进行调整的预制蓝图， 可用于解决代码中反复出现的设计问题。</p>
<p>算法更像是菜谱： 提供达成目标的明确步骤。 而模式更像是蓝图： 你可以看到最终的结果和模式的功能， 但需要自己确定实现步骤。</p>
<h2 id="设计模式的分类"><a href="#设计模式的分类" class="headerlink" title="设计模式的分类"></a>设计模式的分类</h2><ol>
<li><strong>创建型模式</strong>提供<strong>创建对象</strong>的机制， 增加已有代码的灵活性和可复用性。<ul>
<li>工厂方法（Factory Method）</li>
<li>抽象工厂（Abstract Factoy）</li>
<li>生成器（Builder）</li>
<li>原型（Prototype）</li>
<li>单例（Singleton）</li>
</ul>
</li>
<li><strong>结构型模式</strong>介绍如何将对象和类组装成较大的结构， 并同时保持结构的灵活和高效。</li>
<li><strong>行为模式</strong>负责对象间的高效沟通和职责委派</li>
</ol>
<h2 id="工厂方法（Factory-Method）"><a href="#工厂方法（Factory-Method）" class="headerlink" title="工厂方法（Factory Method）"></a>工厂方法（Factory Method）</h2><p>工厂模式建议使用特殊的<strong>工厂方法</strong>来代替对于对象的构造函数的直接调用。</p>
<ol>
<li>工厂方法返回统一的产品<code>product</code>接口：其中工厂里面根据某种条件确定返回哪种产品</li>
<li>统一的产品<code>product</code>接口</li>
<li>客户端执行产品<code>product</code>接口的方法。</li>
</ol>
<p>在工厂方法的内部依据某种条件确定需要生产的实际产品<code>product</code>，调用者其实是根据产品<code>product</code>接口来调用的，不需要关系这种产品真正内部实现，即达到了使用工厂方法对不同产品的调用。</p>
<h3 id="Go实现简单工厂"><a href="#Go实现简单工厂" class="headerlink" title="Go实现简单工厂"></a>Go实现简单工厂</h3><p>由于 Go 中缺少类和继承等 OOP 特性， 所以无法使用 Go 来实现经典的工厂方法模式。 不过， 我们仍然能实现模式的基础版本， 即简单工厂。</p>
<h4 id="产品接口（product）：iGun"><a href="#产品接口（product）：iGun" class="headerlink" title="产品接口（product）：iGun"></a>产品接口（product）：iGun</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> iGun <span class="keyword">interface</span> &#123;</span><br><span class="line">	getName() <span class="type">string</span> <span class="comment">// 返回武器的名称</span></span><br><span class="line">	getPower() <span class="type">int</span>   <span class="comment">// 返回武器的能量大小</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="产品接口的实现：AK和M4"><a href="#产品接口的实现：AK和M4" class="headerlink" title="产品接口的实现：AK和M4"></a>产品接口的实现：AK和M4</h4><p>AK：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> AK <span class="keyword">struct</span> &#123;</span><br><span class="line">	name  <span class="type">string</span></span><br><span class="line">	power <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newAK</span><span class="params">()</span></span> iGun &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;AK&#123;</span><br><span class="line">		name:  <span class="string">&quot;ak47&quot;</span>,</span><br><span class="line">		power: <span class="number">5</span>,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a AK)</span></span> getName() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> a.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a AK)</span></span> getPower() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> a.power</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>M4：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> M4 <span class="keyword">struct</span> &#123;</span><br><span class="line">	name  <span class="type">string</span></span><br><span class="line">	power <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newM4</span><span class="params">()</span></span> iGun &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;M4&#123;</span><br><span class="line">		name:  <span class="string">&quot;m4a1&quot;</span>,</span><br><span class="line">		power: <span class="number">1</span>,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m M4)</span></span> getName() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> m.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m M4)</span></span> getPower() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> m.power</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="工厂方法（factory）：gunFactory"><a href="#工厂方法（factory）：gunFactory" class="headerlink" title="工厂方法（factory）：gunFactory"></a>工厂方法（factory）：gunFactory</h4><p>根据调用者传入的gunType返回具体某种gun。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getGun</span><span class="params">(gunType <span class="type">string</span>)</span></span> (iGun, <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">switch</span> gunType &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;ak&quot;</span>:</span><br><span class="line">		<span class="keyword">return</span> newAK(), <span class="literal">nil</span></span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;m4&quot;</span>:</span><br><span class="line">		<span class="keyword">return</span> newM4(), <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;wrong gun type passed&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ak, _ := getGun(<span class="string">&quot;ak&quot;</span>)</span><br><span class="line">	m4, _ := getGun(<span class="string">&quot;m4&quot;</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">&quot;ak = %#v\n&quot;</span>, ak)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;m4 = %#v\n&quot;</span>, m4)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="抽象工厂（Abstract-Factory）"><a href="#抽象工厂（Abstract-Factory）" class="headerlink" title="抽象工厂（Abstract Factory）"></a>抽象工厂（Abstract Factory）</h2><p><strong>抽象工厂模式</strong>是一种创建型设计模式， 它能创建一系列相关的对象， 而无需指定其具体类。</p>
<h2 id="生成器（Builder）"><a href="#生成器（Builder）" class="headerlink" title="生成器（Builder）"></a>生成器（Builder）</h2><p><strong>生成器模式</strong>是一种创建型设计模式， 使你能够分步骤创建复杂对象。 该模式允许你使用相同的创建代码生成不同类型和形式的对象。常见的使用场景是使用多个<code>build()</code>来构建某一对象</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BuildCPU()</span><br><span class="line">BuildScreen()</span><br><span class="line">BuildBattery()</span><br></pre></td></tr></table></figure>

<h2 id="原型（Prototype）"><a href="#原型（Prototype）" class="headerlink" title="原型（Prototype）"></a>原型（Prototype）</h2><p><strong>原型模式</strong>是一种创建型设计模式， 使你能够复制已有对象， 而又无需使代码依赖它们所属的类。</p>
<h2 id="单例（Singleton）"><a href="#单例（Singleton）" class="headerlink" title="单例（Singleton）"></a>单例（Singleton）</h2><p><strong>单例模式</strong>是一种创建型设计模式， 让你能够保证一个类只有一个实例， 并提供一个访问该实例的全局节点。</p>
<h2 id="代理（Proxy）"><a href="#代理（Proxy）" class="headerlink" title="代理（Proxy）"></a>代理（Proxy）</h2><p><strong>代理模式</strong>是一种结构型设计模式， 让你能够提供对象的替代品或其占位符。 代理控制着对于原对象的访问， 并允许在将请求提交给对象前后进行一些处理。</p>
<h2 id="适配器（Adapter）"><a href="#适配器（Adapter）" class="headerlink" title="适配器（Adapter）"></a>适配器（Adapter）</h2><p><strong>适配器模式</strong>是一种结构型设计模式， 它能使接口不兼容的对象能够相互合作。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2023/07/19/design-pattern/design-pattern/%E7%BB%93%E5%90%88Java%E5%92%8CGolang%E5%AD%A6%E4%B9%A0%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" data-id="clsblyudu000jw0k6cua26jp9" data-title="结合Java和Golang学习设计模式" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-back-end/database/mysql进阶" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/19/back-end/database/mysql%E8%BF%9B%E9%98%B6/" class="article-date">
  <time class="dt-published" datetime="2023-07-19T07:30:39.000Z" itemprop="datePublished">2023-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/19/back-end/database/mysql%E8%BF%9B%E9%98%B6/">MySQL进阶简单梳理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="1、DB、DBMS、SQL分别是什么，他们之间存在什么联系？"><a href="#1、DB、DBMS、SQL分别是什么，他们之间存在什么联系？" class="headerlink" title="1、DB、DBMS、SQL分别是什么，他们之间存在什么联系？"></a>1、DB、DBMS、SQL分别是什么，他们之间存在什么联系？</h2><ul>
<li>DB：DataBase（数据库），数据库在硬盘上是以文件的形式存在的。</li>
<li>DBMS：DataBase Management System（数据库管理系统），比如：Oracle、MySQL、SqlServer…</li>
<li>SQL：Structured Query Language（结构化查询语言），是一门高级语言。SQL语句先由DBMS进行编译然后再执行。</li>
</ul>
<p>DBMS负责编译和执行SQL语句，然后操作DB。</p>
<h2 id="2、存储引擎"><a href="#2、存储引擎" class="headerlink" title="2、存储引擎"></a>2、存储引擎</h2><p>MySQL默认建表的时候的存储引擎是<code>InnoDB</code>；</p>
<p>在MySQL中叫<code>存储引擎</code>，在Oracle中叫<code>表的存储方式</code></p>
<p>MySQL常用的存储引擎有：</p>
<ol>
<li><p>MyISAM</p>
<p>一张表有三种格式文件组成：</p>
<ul>
<li>table_name.frm（表结构）</li>
<li>table_name.MYD（表数据）</li>
<li>table_name.MYI（表索引）</li>
</ul>
<p>优点：能够压缩，且可以只读，节省空间。</p>
<p>缺点：不支持事务。</p>
</li>
<li><p>InnoDB（默认）</p>
<p>表由table_name.frm（物理结构）组成的并且存储在tablespace表空间（逻辑结构）中</p>
<p>优点：支持事务、行级锁、外键。是安全的，支持级联删除、更新。支持事务的ACID原则。</p>
<p>Tip：ACID是指：</p>
<p><strong>原子性</strong>（atomicity）：要么全部提交成功，要么全部失败回滚。</p>
<p><strong>一致性</strong>（consistency）：一个事务在执行之前和执行之后，数据库都必须处于一致性状态。</p>
<p><strong>隔离性</strong>（isolation）：事务的隔离性是指在并发环境中，并发的事务时相互隔离的，一个事务的执行不能不被其他事务干扰。</p>
<p><strong>持久性</strong>（durability）：一旦事务提交，那么它对数据库中的对应数据的状态的变更就会永久保存到数据库中。</p>
</li>
<li><p>MEMORY（内存）</p>
<p>表由table_name.frm格式文件存储</p>
<p>存储在内存中</p>
<p>优点：查询效率特别高</p>
<p>缺点：不支持事务。数据容易丢失。</p>
</li>
</ol>
<h2 id="3、事务"><a href="#3、事务" class="headerlink" title="3、事务"></a>3、事务</h2><p>事务（Transaction）：一条事务就是一个完整的业务逻辑单元，不可以再分。</p>
<p>和事务相关的语句只有DML语句。（insert delete update）</p>
<p>事务机制：先开启事务机制，事务中执行了insert、update或者delete后不会立马修改文件，而是被记录到缓存和日志中，待事务结束（事务成功，删除缓存和日志并且提交修改到文件（commit）；事务失败，删除缓存和日志并且不提交修改到文件（rollback））</p>
<p>DQL（Data Quer yLanguage）：数据查询语言</p>
<p>DML（Data Manipulation Language）：数据操作语言</p>
<p>DDL（Data Definition Language）：数据定义语言</p>
<p>DCL（Data Control Language）：数据控制语言</p>
<p>事务的四种隔离级别：</p>
<p>读未提交（Read uncommitted）：A事务能够读到B事务还未提交的数据；如果B事务发生回滚则A事务会发生<strong>脏读</strong>（Dirty read）。</p>
<p>读已提交（Read committed）：A事务读B事务已经提交的数据。解决了脏读。但会发生<strong>不可重复读</strong>。SqlServer、Oracle的默认隔离级别是Read committed。</p>
<p>可重复读（Repeatable read）：B事务无论怎么改数据，A事务读到的永远是A事务并没有结束事务并且刚开始读到的数据。但是这个时候其实B事务已经改了数据了，A事务就会发生<strong>幻读</strong>。解决了不可重复读。</p>
<p>串行化（serializable）：所有事务按顺序执行。以上所有问题都被解决，但是<strong>效率低</strong>。</p>
<h2 id="4、数据库设计三范式"><a href="#4、数据库设计三范式" class="headerlink" title="4、数据库设计三范式"></a>4、数据库设计三范式</h2><p>设计范式：是为了减少设计表的时候出现数据冗余。</p>
<p>第一范式：任何一张表都应该有主键，并且每一个字段原子性不能再分。</p>
<p>第二范式：在第一范式的基础上，所有非主键字段完全依赖主键，不可产生部分依赖。（多对多，两张表，关系表，两外键）</p>
<p>第三范式：在第二范式的基础上，不能产生传递依赖。（一对多，多的表放外键）</p>
<p><strong>Tip</strong>：实际开发中，以满足客户需求为主，有时候会拿冗余换执行速度。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2023/07/19/back-end/database/mysql%E8%BF%9B%E9%98%B6/" data-id="clsblyudv000lw0k67c7m77by" data-title="MySQL进阶简单梳理" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-back-end/database/乐观锁和悲观锁" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/19/back-end/database/%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81/" class="article-date">
  <time class="dt-published" datetime="2023-07-19T07:30:39.000Z" itemprop="datePublished">2023-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/19/back-end/database/%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81/">乐观锁和悲观锁</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="1、乐观锁"><a href="#1、乐观锁" class="headerlink" title="1、乐观锁"></a>1、乐观锁</h2><p>在关系型数据库管理系统中，<strong>乐观并发控制</strong>（又名：<strong>“乐观锁”</strong>，Optimistic Concurrency Control，缩写“OCC”），是一种并发控制的方法。多适用于<strong>读多写少</strong>的场景。</p>
<p>它假设多用户并发的事务在处理时<strong>不会彼此互相影响</strong>，各事务能够在不产生锁的情况下处理各自影响的那部分数据。</p>
<p>在提交数据更新之前，每个事务会先检查在事务在读取数据后，有没有其他事务由修改了该数据。如果有其他事务有更新的话，正在提交的事务就会回滚。</p>
<p>——摘自维基百科：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-cn/%E4%B9%90%E8%A7%82%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6">乐观并发控制</a></p>
<blockquote>
<p>Tips：</p>
<p>乐观锁的“乐观”体现在：操作数据的时候比较乐观，认为其他事务不会同时修改数据，所以不会对数据上锁，只不过需要在对数据进行更新的时候判断一下在此期间（拿到数据到更新数据期间）其他事务有没有去更改该数据。</p>
<p>需要特别注意：乐观锁机制本身并不会对数据加锁。</p>
</blockquote>
<h3 id="乐观锁的步骤"><a href="#乐观锁的步骤" class="headerlink" title="乐观锁的步骤"></a>乐观锁的步骤</h3><p>采用乐观锁的修改事务包含以下步骤：</p>
<ol>
<li><strong>读取</strong>：事务将数据读入，此时系统会给事务分派一个时间戳。</li>
<li><strong>检验</strong>：事务执行完毕后，尝试进行提交。此时同步校验其他事务，如果当前事务所读取的数据在读取之后又被其他事务进行修改，则当前事务回滚。</li>
<li><strong>写入</strong>：通过校验阶段后，将更新的数据写入数据库。</li>
</ol>
<h3 id="版本号机制"><a href="#版本号机制" class="headerlink" title="版本号机制"></a>版本号机制</h3><p>加上版本号version字段。即为数据增加一个版本标识，一般是通过为数据库表增加一个数字类型的 “version” 字段来实现。当读取数据时，将version字段的值一同读出，数据每更新一次，对此version值加一。当我们提交更新的时候，判断数据库表对应记录的当前版本信息与第一次取出来的version值进行比对，如果数据库表当前版本号与第一次取出来的version值相等，则予以更新，否则认为是过期数据。</p>
<h3 id="CAS算法"><a href="#CAS算法" class="headerlink" title="CAS算法"></a>CAS算法</h3><p>CAS（Compare And Swap，先比较再交换算法）是一种常见的“乐观锁”。大部分的CPU都有对应的汇编指令，它有三个操作数：内存地址V，旧值A，新值B。只有当内存地址V上的值是A，B才会被写到V上，否则操作失败。</p>
<h3 id="ABA问题"><a href="#ABA问题" class="headerlink" title="ABA问题"></a>ABA问题</h3><p>ABA问题是无锁结构实现中常见的一种问题，表述为：</p>
<ol>
<li>进程P1读取了数值A</li>
<li>P1被挂起（时间片耗尽、中断等），进程P2开始执行</li>
<li>P2修改了数值A为数值B，然后又修改回A</li>
<li>P1被唤醒，比较后发现数值A没有变化，程序继续执行。</li>
</ol>
<h2 id="2、悲观锁"><a href="#2、悲观锁" class="headerlink" title="2、悲观锁"></a>2、悲观锁</h2><p>在关系型数据库管理系统中，<strong>悲观并发控制</strong>（又名：<strong>悲观锁</strong>，Pessimistic Concurrency Control，缩写“PCC”），是一种并发控制的方法。多适用于<strong>读少写多</strong>的场景。</p>
<p>它可以阻止一个事务以影响其他用户的方式来修改数据。如果一个事务执行的操作读某行数据应用了锁，那只有当这个事务把锁释放，其他事务才能够执行与该锁冲突的操作。</p>
<p>——摘自维基百科：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-cn/%E6%82%B2%E8%A7%82%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6">悲观并发控制</a></p>
<blockquote>
<p>Tips：</p>
<p>悲观锁的“悲观”体现在：操作数据的时候比较悲观，认为其他事务也会同时修改数据（所以才会提前在当前事务上锁，避免同时被其他事务访问或者修改）。</p>
</blockquote>
<h3 id="悲观锁的步骤"><a href="#悲观锁的步骤" class="headerlink" title="悲观锁的步骤"></a>悲观锁的步骤</h3><p>采用悲观锁的修改事务往往会在修改数据时为该数据加上“锁”（即只允许当前事务访问，不允许其他事务访问或者修改）。</p>
<h3 id="共享锁（读锁）Shared-Lock"><a href="#共享锁（读锁）Shared-Lock" class="headerlink" title="共享锁（读锁）Shared Lock"></a>共享锁（读锁）Shared Lock</h3><p>多个事务对同一数据可以共享一把锁，即能够访问到数据，但是不能修改。</p>
<p>在查询语句后面增加<code>LOCK IN SHARE MODE</code>，数据库就会对<strong>查询结果中的记录</strong>加上共享锁。如</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... LOCK <span class="keyword">IN</span> SHARE MODE;</span><br></pre></td></tr></table></figure>

<p>当没有其他线程对查询结果集中的任何一行使用排他锁时，可以成功申请共享锁，否则会被阻塞。其他线程也可以读取使用了共享锁的表，而且这些线程读取的是<strong>同一个版本的数据</strong>。</p>
<h3 id="排他锁（写锁）Exclusive-Lock"><a href="#排他锁（写锁）Exclusive-Lock" class="headerlink" title="排他锁（写锁）Exclusive Lock"></a>排他锁（写锁）Exclusive Lock</h3><p>排他锁就是不能与其他锁共存，如一个事务获取了一个数据的排他锁，该事务就不能获取该行的其他锁，但是获取到排他锁的事务是可以对数据进行读取和修改的。</p>
<p>在查询语句后面增加<code>FOR UPDATE</code>，数据库就会对<strong>查询结果中的记录</strong>加上排他锁。如</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FOR</span> <span class="keyword">UPDATE</span></span><br></pre></td></tr></table></figure>

<p>当没有其他线程对查询结果集中的任何一行使用排他锁时，可以成功申请排他锁，否则会被阻塞。</p>
<h3 id="数据库行锁、表锁"><a href="#数据库行锁、表锁" class="headerlink" title="数据库行锁、表锁"></a>数据库行锁、表锁</h3><p>行锁往往是在update时候才会生效，锁住条件所命中的行。</p>
<p>表锁往往是在insert的时候才会生效，锁住命中的表。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2023/07/19/back-end/database/%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81/" data-id="clsblyudx000mw0k66cjd7x7c" data-title="乐观锁和悲观锁" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-back-end/docker/docker学习" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/19/back-end/docker/docker%E5%AD%A6%E4%B9%A0/" class="article-date">
  <time class="dt-published" datetime="2023-07-19T07:30:39.000Z" itemprop="datePublished">2023-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/19/back-end/docker/docker%E5%AD%A6%E4%B9%A0/">docker学习</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="1、安装docker"><a href="#1、安装docker" class="headerlink" title="1、安装docker"></a>1、安装docker</h2><p><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/macos-docker-install.html">https://www.runoob.com/docker/macos-docker-install.html</a></p>
<p>选择匹配自己操作系统的版本进行安装，如果比较慢的话可以使用阿里的开源镜像站下载：</p>
<p><a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/docker-toolbox/">http://mirrors.aliyun.com/docker-toolbox/</a></p>
<h2 id="2、配置docker镜像源加速"><a href="#2、配置docker镜像源加速" class="headerlink" title="2、配置docker镜像源加速"></a>2、配置docker镜像源加速</h2><p>由于docker下载镜像默认是从dockerhub上下载，会比较慢，所以建议配置国内的镜像源，具体配置方法参看：</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-mirror-acceleration.html">https://www.runoob.com/docker/docker-mirror-acceleration.html</a></p>
<h2 id="3、docker的基本概念"><a href="#3、docker的基本概念" class="headerlink" title="3、docker的基本概念"></a>3、docker的基本概念</h2><p>Docker 包括三个基本概念:</p>
<ul>
<li><strong>镜像（Image）</strong>：Docker 镜像（Image），就相当于是一个 root 文件系统。比如官方镜像 ubuntu:16.04 就包含了完整的一套 Ubuntu16.04 最小系统的 root 文件系统。</li>
<li><strong>容器（Container）</strong>：镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和实例一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。</li>
<li><strong>仓库（Repository）</strong>：仓库可看成一个代码控制中心，用来保存镜像。</li>
</ul>
<h2 id="4、docker容器（container）"><a href="#4、docker容器（container）" class="headerlink" title="4、docker容器（container）"></a>4、docker容器（container）</h2><h3 id="运行容器（run）"><a href="#运行容器（run）" class="headerlink" title="运行容器（run）"></a>运行容器（run）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run</span><br></pre></td></tr></table></figure>

<h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><ul>
<li>-t：在新容器内指定一个伪终端或终端。</li>
<li>-i：允许你对容器内的标准输入 (STDIN) 进行交互。</li>
<li>-d：以后台模式启动容器</li>
<li>-p：容器内部端口绑定到<strong>指定</strong>的主机端口。</li>
<li>-P：容器内部端口<strong>随机</strong>映射到主机的高端口。</li>
<li>–name：命名容器</li>
</ul>
<h3 id="列出容器（ps）"><a href="#列出容器（ps）" class="headerlink" title="列出容器（ps）"></a>列出容器（ps）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure>

<p>（默认）查看<strong>正在运行</strong>的容器</p>
<p><img src="/2023/07/19/back-end/docker/docker%E5%AD%A6%E4%B9%A0/image-20211216154455337.png"></p>
<p><strong>CONTAINER ID:</strong> 容器 ID。</p>
<p><strong>IMAGE:</strong> 使用的镜像。</p>
<p><strong>COMMAND:</strong> 启动容器时运行的命令。</p>
<p><strong>CREATED:</strong> 容器的创建时间。</p>
<p><strong>STATUS:</strong> 容器状态。</p>
<p>状态有7种：</p>
<ul>
<li>created（已创建）</li>
<li>restarting（重启中）</li>
<li>running 或 Up（运行中）</li>
<li>removing（迁移中）</li>
<li>paused（暂停）</li>
<li>exited（停止）</li>
<li>dead（死亡）</li>
</ul>
<p><strong>PORTS:</strong> 容器的端口信息和使用的连接类型（tcp\udp）。</p>
<p><strong>NAMES:</strong> 自动分配的容器名称。</p>
<h4 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h4><ul>
<li>-a：查看<strong>所有</strong>容器</li>
<li>-l：查询最后一次创建的容器</li>
</ul>
<h3 id="查看容器内的标准输出（logs）"><a href="#查看容器内的标准输出（logs）" class="headerlink" title="查看容器内的标准输出（logs）"></a>查看容器内的标准输出（logs）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs &lt;CONTAINER ID&gt; | &lt;NAMES&gt;</span><br></pre></td></tr></table></figure>

<h4 id="参数-2"><a href="#参数-2" class="headerlink" title="参数"></a>参数</h4><ul>
<li>-f：像<code>tail -f</code>一样来进行标准输出（追加输出正在变化的文件）</li>
</ul>
<h3 id="停止容器（stop）"><a href="#停止容器（stop）" class="headerlink" title="停止容器（stop）"></a>停止容器（stop）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop &lt;CONTAINER ID&gt; | &lt;NAMES&gt;</span><br></pre></td></tr></table></figure>

<h3 id="重启容器（restart）"><a href="#重启容器（restart）" class="headerlink" title="重启容器（restart）"></a>重启容器（restart）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart &lt;CONTAINER ID&gt; | &lt;NAMES&gt;</span><br></pre></td></tr></table></figure>

<h3 id="启动停止的容器（start）"><a href="#启动停止的容器（start）" class="headerlink" title="启动停止的容器（start）"></a>启动停止的容器（start）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start &lt;CONTAINER ID&gt; | &lt;NAMES&gt;</span><br></pre></td></tr></table></figure>

<h3 id="进入后台运行的容器（exec）"><a href="#进入后台运行的容器（exec）" class="headerlink" title="进入后台运行的容器（exec）"></a>进入后台运行的容器（exec）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> &lt;CONTAINER ID&gt; | &lt;NAMES&gt;</span><br></pre></td></tr></table></figure>

<p>根据容器编号或者容器名称来进入一个后台运行的容器</p>
<p>如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% docker <span class="built_in">exec</span> -it 5262dfdbd369 /bin/bash</span><br></pre></td></tr></table></figure>

<h3 id="导出容器为镜像（export）"><a href="#导出容器为镜像（export）" class="headerlink" title="导出容器为镜像（export）"></a>导出容器为镜像（export）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">export</span> &lt;CONTAINER ID&gt; &gt; &lt;filename&gt;</span><br></pre></td></tr></table></figure>

<p>将本地的某个容器导出为<strong>镜像</strong></p>
<p>如：到当前位置下的docker目录中，名称为ubuntu.tar</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% docker <span class="built_in">export</span> 5262dfdbd369 &gt; ./docker/ubuntu.tar</span><br></pre></td></tr></table></figure>

<h3 id="导入镜像（import）"><a href="#导入镜像（import）" class="headerlink" title="导入镜像（import）"></a>导入镜像（import）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker import</span><br></pre></td></tr></table></figure>

<p>将远程或者本地的某个容器导入为<strong>镜像</strong></p>
<p>如：将当前位置下的docker目录中的ubuntu.tar导为镜像test&#x2F;ubuntu:v1</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./docker/ubuntu.tar | docker import - <span class="built_in">test</span>/ubuntu:v1</span><br></pre></td></tr></table></figure>

<p>如：从远程导入某个容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker import http://example.com/exampleimage.tgz example/imagerepo</span><br></pre></td></tr></table></figure>

<h3 id="删除容器（rm）"><a href="#删除容器（rm）" class="headerlink" title="删除容器（rm）"></a>删除容器（rm）</h3><p>（容器必须是停止状态）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">rm</span> &lt;CONTAINER ID&gt; | &lt;NAMES&gt;</span><br></pre></td></tr></table></figure>

<p>如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">rm</span> -f 5262dfdbd369</span><br></pre></td></tr></table></figure>

<h3 id="查看容器映射的端口号（port）"><a href="#查看容器映射的端口号（port）" class="headerlink" title="查看容器映射的端口号（port）"></a>查看容器映射的端口号（port）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker port &lt;CONTAINER ID&gt; | &lt;NAMES&gt;</span><br></pre></td></tr></table></figure>

<h3 id="查看容器内部运行的进程（top）"><a href="#查看容器内部运行的进程（top）" class="headerlink" title="查看容器内部运行的进程（top）"></a>查看容器内部运行的进程（top）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker top &lt;CONTAINER ID&gt; | &lt;NAMES&gt;</span><br></pre></td></tr></table></figure>

<h3 id="查看容器的配置以及状态信息（inspect）"><a href="#查看容器的配置以及状态信息（inspect）" class="headerlink" title="查看容器的配置以及状态信息（inspect）"></a>查看容器的配置以及状态信息（inspect）</h3><p>会返回一个JSON格式的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect &lt;CONTAINER ID&gt; | &lt;NAMES&gt;</span><br></pre></td></tr></table></figure>

<h2 id="5、docker镜像（image）"><a href="#5、docker镜像（image）" class="headerlink" title="5、docker镜像（image）"></a>5、docker镜像（image）</h2><h3 id="列出镜像（images）"><a href="#列出镜像（images）" class="headerlink" title="列出镜像（images）"></a>列出镜像（images）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<p>列出本机上的所有镜像</p>
<p><img src="/2023/07/19/back-end/docker/docker%E5%AD%A6%E4%B9%A0/image-20211216165241664.png"></p>
<ul>
<li><strong>REPOSITORY：</strong>表示镜像的仓库源</li>
<li><strong>TAG：</strong>镜像的标签（代表该镜像的不同版本）</li>
<li><strong>IMAGE ID：</strong>镜像ID</li>
<li><strong>CREATED：</strong>镜像创建时间</li>
<li><strong>SIZE：</strong>镜像大小</li>
</ul>
<p>如：<code>ubuntu:15.10</code>即指定ubuntu的15.10版本。</p>
<p>如：<code>training/webapp</code>不指定版本，则是会默认使用latest（最近）的版本。</p>
<h3 id="拉取镜像（pull）"><a href="#拉取镜像（pull）" class="headerlink" title="拉取镜像（pull）"></a>拉取镜像（pull）</h3><p>会从dockerhub中拉取镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull</span><br></pre></td></tr></table></figure>

<p>如：下载mysql的镜像</p>
<p><img src="/2023/07/19/back-end/docker/docker%E5%AD%A6%E4%B9%A0/image-20211216171635678.png"></p>
<h3 id="查看镜像（search）"><a href="#查看镜像（search）" class="headerlink" title="查看镜像（search）"></a>查看镜像（search）</h3><p>可以从dockerhub来搜索镜像，或者使用search来根据关键字搜索镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search</span><br></pre></td></tr></table></figure>

<p>如：搜索关键字<code>httpd</code></p>
<p><img src="/2023/07/19/back-end/docker/docker%E5%AD%A6%E4%B9%A0/image-20211216171941131.png"></p>
<p><strong>NAME:</strong> 镜像仓库源的名称</p>
<p><strong>DESCRIPTION:</strong> 镜像的描述</p>
<p><strong>OFFICIAL:</strong> 是否 docker 官方发布</p>
<p><strong>stars:</strong> 类似 Github 里面的 star，表示点赞、喜欢的意思。</p>
<p><strong>AUTOMATED:</strong> 自动构建。</p>
<h3 id="删除镜像（rmi）"><a href="#删除镜像（rmi）" class="headerlink" title="删除镜像（rmi）"></a>删除镜像（rmi）</h3><p>（需要先移除使用到该镜像的容器）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi &lt;REPOSITORY&gt; | &lt;IMAGE ID&gt;</span><br></pre></td></tr></table></figure>

<h3 id="利用commit创建镜像（commit）"><a href="#利用commit创建镜像（commit）" class="headerlink" title="利用commit创建镜像（commit）"></a>利用commit创建镜像（commit）</h3><h4 id="参数-3"><a href="#参数-3" class="headerlink" title="参数"></a>参数</h4><ul>
<li><strong>-m:</strong> 提交的描述信息</li>
<li><strong>-a:</strong> 指定镜像作者</li>
<li><strong>0824479d7fcd：</strong>容器 ID</li>
<li><strong>test&#x2F;ubuntu:v1:</strong> 指定要创建的目标镜像名</li>
</ul>
<p>在对旧的镜像进行修改后可以提交为新的镜像</p>
<ol>
<li><p>运行镜像为容器</p>
<p><code>% docker run -it ubuntu:15.10 /bin/bash</code></p>
</li>
<li><p>在容器中升级</p>
<p><code>apt-get update</code></p>
</li>
<li><p>退出容器</p>
<p><code>exit</code></p>
</li>
<li><p>将修改后的容器提交为新的镜像</p>
<p><code>% docker commit -m=&quot;ubuntu update&quot; -a=&quot;test&quot; 0824479d7fcd test/ubuntu:v1 </code></p>
</li>
</ol>
<h3 id="利用dockerfile创建镜像（build）"><a href="#利用dockerfile创建镜像（build）" class="headerlink" title="利用dockerfile创建镜像（build）"></a>利用dockerfile创建镜像（build）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build &lt;dockerfilename&gt;</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<ul>
<li><strong>-t</strong> ：指定要创建的目标镜像名</li>
<li><strong><dockerfilename></strong> ：Dockerfile 文件所在目录，可以指定Dockerfile 的绝对路径</li>
</ul>
<p>如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t wqk/centos:6.7 ./dockerfile_test</span><br></pre></td></tr></table></figure>

<p>利用当前目录下的dockerfile_test dockerfile文件创建一个wqk&#x2F;centos:6.7镜像</p>
<h3 id="设置镜像标签（tag）"><a href="#设置镜像标签（tag）" class="headerlink" title="设置镜像标签（tag）"></a>设置镜像标签（tag）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag CONTAINER_ID AUTH_NAME/REPOSITORY_NAME:TAG</span><br></pre></td></tr></table></figure>

<p>如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag 860c279d2fec runoob/centos:dev</span><br></pre></td></tr></table></figure>

<p>docker tag 镜像ID，这里是 860c279d2fec ,用户名称、镜像源名(repository name)和新的标签名(tag)。</p>
<h2 id="6、docker-compose"><a href="#6、docker-compose" class="headerlink" title="6、docker-compose"></a>6、docker-compose</h2><p>Compose 是用于定义和运行<strong>多容器</strong> Docker 应用程序的工具。通过 Compose，您可以使用 YML 文件来配置应用程序需要的所有服务。然后，使用一个命令，就可以从 YML 文件配置中创建并启动所有服务。</p>
<p>Compose 使用的三个步骤：</p>
<ol>
<li>使用 Dockerfile 定义应用程序的环境。</li>
<li>使用 docker-compose.yml 定义构成应用程序的服务，这样它们可以在隔离环境中一起运行。</li>
<li>最后，执行 docker-compose up 命令来启动并运行整个应用程序。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2023/07/19/back-end/docker/docker%E5%AD%A6%E4%B9%A0/" data-id="clsblyudz000pw0k660k8ajt0" data-title="docker学习" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-back-end/go/gin" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/19/back-end/go/gin/" class="article-date">
  <time class="dt-published" datetime="2023-07-19T07:30:39.000Z" itemprop="datePublished">2023-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/19/back-end/go/gin/">Gin框架的学习</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="什么是Gin？"><a href="#什么是Gin？" class="headerlink" title="什么是Gin？"></a>什么是Gin？</h1><p>Gin 是一个用 Go (Golang) 编写的 web 框架。 它是一个类似于 <a target="_blank" rel="noopener" href="https://github.com/go-martini/martini">martini</a> 但拥有更好性能的 API 框架, 由于 <a target="_blank" rel="noopener" href="https://github.com/julienschmidt/httprouter">httprouter</a>，速度提高了近 40 倍。 如果你是性能和高效的追求者, 你会爱上 Gin。</p>
<p><a target="_blank" rel="noopener" href="https://gin-gonic.com/zh-cn/docs/introduction/">中文官方文档地址</a></p>
<h1 id="安装Gin"><a href="#安装Gin" class="headerlink" title="安装Gin"></a>安装Gin</h1><p>使用Go Modules安装Gin</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go get -u github.com/gin-gonic/gin</span><br></pre></td></tr></table></figure>



<h1 id="第一个Gin应用"><a href="#第一个Gin应用" class="headerlink" title="第一个Gin应用"></a>第一个Gin应用</h1><p>创建main.go，注意目录结构，同时需要确保go.mod中已经引入gin</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">│  go.mod</span><br><span class="line">│  go.sum</span><br><span class="line">│  main.go</span><br></pre></td></tr></table></figure>

<p>main.go：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="comment">//默认的路由引擎</span></span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//检查连接</span></span><br><span class="line">	r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">			<span class="string">&quot;message&quot;</span>:<span class="string">&quot;gin-demo server is running by gin&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//启动Web服务</span></span><br><span class="line">	r.Run(<span class="string">&quot;:9090&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>利用<code>gin.Default()</code>创建默认的路由引擎<code>r</code></li>
<li><code>r.GET()</code>即是处理HTTP请求中的GET方法</li>
<li><code>r.Run()</code>加上端口号即是启动web服务</li>
</ol>
<h1 id="处理HTTP请求"><a href="#处理HTTP请求" class="headerlink" title="处理HTTP请求"></a>处理HTTP请求</h1><p>处理HTTP请求的GET方法是使用r.GET( )，第一个参数是处理的URI地址，第二个参数是具体的处理函数，上述是匿名函数的写法，你也可以写成具名函数，如：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="comment">//默认的路由引擎</span></span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//检查连接</span></span><br><span class="line">	r.GET(<span class="string">&quot;/&quot;</span>,index)</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//启动Web服务</span></span><br><span class="line">	r.Run(<span class="string">&quot;:9090&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">index</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">        <span class="string">&quot;message&quot;</span>:<span class="string">&quot;gin-demo server is running by gin&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同理，处理POST方法即是<code>r.POST() </code>，PUT方法是<code>r.PUT()</code>等。如果想要同时匹配全部的HTTP请求的方法，可以使用<code>r.Any()</code></p>
<h1 id="返回JSON"><a href="#返回JSON" class="headerlink" title="返回JSON"></a>返回JSON</h1><p>可以利用<code>c.JSON(code int, obj interface&#123;&#125;)</code>来返回JSON数据</p>
<p>gin内置的gin.H数据类型实际上就是Map[string]interface{}数据类型，以key-value的形式返回JSON数据</p>
<p>gin.H：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> H <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">   c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">      <span class="string">&quot;message&quot;</span>:<span class="string">&quot;gin-demo server is running by gin&quot;</span>,</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>返回的数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gin-demo server is running by gin&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>同理返回JSON对象则是</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name    <span class="type">string</span> <span class="string">`json:&quot;name,omitempty&quot; form:&quot;name&quot;`</span></span><br><span class="line">	Age     <span class="type">int</span>    <span class="string">`json:&quot;age,omitempty&quot; form:&quot;age&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    <span class="comment">//返回JSON对象</span></span><br><span class="line">    r.GET(<span class="string">&quot;/student&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        student := &amp;Student&#123;</span><br><span class="line">            Name:    <span class="string">&quot;student&quot;</span>,</span><br><span class="line">            Age:     <span class="number">20</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//返回JSON类型的对象</span></span><br><span class="line">        c.JSON(http.StatusOK,student)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回的数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;student&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">20</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Tips</strong></p>
<p>需要以JSON数据格式返回的属性的首字母需要大写（因为本质实际上就是通过反射来判断该结构体对象的字段是否能够导出），同时需要加上tag：`json:”name”`使得具体返回的字段名有tag决定，如果没有指定则是返回属性名，即Name</p>
</blockquote>
<h1 id="获取query参数（Query）"><a href="#获取query参数（Query）" class="headerlink" title="获取query参数（Query）"></a>获取query参数（Query）</h1><p>可以利用<code>c.Query(key)</code>、<code>c.GetQuery(key)</code>、<code>c.DefaultQuery(key,defaultValue)</code>来获取query中的参数</p>
<p>如：path</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:9090/query?id=1&amp;name=test&amp;age=18</span><br></pre></td></tr></table></figure>

<p>则可以分别用过上述三种方式来获取参数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/query&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">//1、直接获取query</span></span><br><span class="line">    id := c.Query(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">    <span class="comment">//2、获取query（返回value和ok）</span></span><br><span class="line">    name, _ := c.GetQuery(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    <span class="comment">//3、获取并且设置可能的默认值</span></span><br><span class="line">    age := c.DefaultQuery(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">    c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: id,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: age,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h1 id="获取form表单参数（PostForm）"><a href="#获取form表单参数（PostForm）" class="headerlink" title="获取form表单参数（PostForm）"></a>获取form表单参数（PostForm）</h1><p>可以利用<code>c.PostForm(key)</code>、<code>c.GetPostForm(key)</code>、<code>c.DefaultPostForm(key,defaultValue)</code>来获取form（POST）表单提交的参数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/form&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">//1、直接获取form中的value</span></span><br><span class="line">    id := c.PostForm(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">    <span class="comment">//2、获取form中value（返回value和ok）</span></span><br><span class="line">    name, _ := c.GetPostForm(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    <span class="comment">//3、返回form中的value并且设置可能的默认值</span></span><br><span class="line">    age := c.DefaultPostForm(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;10&quot;</span>)</span><br><span class="line">    c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: id,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: age,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h1 id="获取path路径参数URI（Param）"><a href="#获取path路径参数URI（Param）" class="headerlink" title="获取path路径参数URI（Param）"></a>获取path路径参数URI（Param）</h1><p>可以利用<code>c.Param(key)</code>来获取path中的参数（URI）</p>
<p>如：path</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:9090/path/10/18</span><br></pre></td></tr></table></figure>

<p>则</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//path中使用`/:param`的方式来定义路径参数</span></span><br><span class="line">r.GET(<span class="string">&quot;/path/:id/:age&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">//获取路径参数</span></span><br><span class="line">    id := c.Param(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">    <span class="comment">//params := c.Params	//可以使用c.Params来获取所有路径参数</span></span><br><span class="line">    c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: id,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h1 id="参数绑定至结构体（ShouldBind）"><a href="#参数绑定至结构体（ShouldBind）" class="headerlink" title="参数绑定至结构体（ShouldBind）"></a>参数绑定至结构体（ShouldBind）</h1><p>在大多数时候，返回的参数很多的情况下，如果使用Query或者PostForm去一一获取可能会比较慢，我们可以预先定义好结构体，然后在直接使用参数绑定<code>ShouldBind()</code>来使得参数能够自动匹配到结构体对象上。在这之前，我们需要先定义结构体</p>
<h2 id="定义结构体"><a href="#定义结构体" class="headerlink" title="定义结构体"></a>定义结构体</h2><p>切记：需要在结构体上加上form的tag</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">   Name    <span class="type">string</span> <span class="string">`json:&quot;name,omitempty&quot; form:&quot;name&quot;`</span></span><br><span class="line">   Age     <span class="type">int</span>    <span class="string">`json:&quot;age,omitempty&quot; form:&quot;age&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="绑定GET的query"><a href="#绑定GET的query" class="headerlink" title="绑定GET的query"></a>绑定GET的query</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/bindGet&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">//新建空对象</span></span><br><span class="line">    <span class="keyword">var</span> s Student</span><br><span class="line">    <span class="comment">//传入对象的地址</span></span><br><span class="line">    err := c.ShouldBind(&amp;s)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="comment">//参数绑定失败</span></span><br><span class="line">        c.JSON(http.StatusBadRequest,gin.H&#123;</span><br><span class="line">            <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;student = %v&quot;</span>,s)</span><br><span class="line">    c.JSON(http.StatusOK,s)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="绑定POST的form"><a href="#绑定POST的form" class="headerlink" title="绑定POST的form"></a>绑定POST的form</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/bindForm&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> s Student</span><br><span class="line">    err := c.ShouldBind(&amp;s)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="comment">//参数绑定失败</span></span><br><span class="line">        c.JSON(http.StatusBadRequest,gin.H&#123;</span><br><span class="line">            <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;student = %v&quot;</span>,s)</span><br><span class="line">    c.JSON(http.StatusOK,s)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="绑定JSON对象"><a href="#绑定JSON对象" class="headerlink" title="绑定JSON对象"></a>绑定JSON对象</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/bindJson&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> s Student</span><br><span class="line">    err := c.ShouldBind(&amp;s)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="comment">//参数绑定失败</span></span><br><span class="line">        c.JSON(http.StatusBadRequest,gin.H&#123;</span><br><span class="line">            <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;student = %v&quot;</span>,s)</span><br><span class="line">    c.JSON(http.StatusOK,s)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>Tips</strong></p>
<p>基本上来自GET请求的query和POST请求的form对象以及json对象都能自动绑定到结构体对象上，不过需要注意的是需要传入<strong>对象的指针</strong></p>
</blockquote>
<h1 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h1><p>文件上传需要注意两个步骤</p>
<ol>
<li>从POST请求（form表单）中读取文件（需要处理错误）</li>
<li>尝试将读取到的文件保存的服务端本地（需要处理错误）</li>
</ol>
<h2 id="单个文件上传"><a href="#单个文件上传" class="headerlink" title="单个文件上传"></a>单个文件上传</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/upload&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">//1、从请求中读取文件</span></span><br><span class="line">    file, err := c.FormFile(<span class="string">&quot;file&quot;</span>) <span class="comment">//根据文件的标识来获取文件（form表单的name属性）</span></span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="comment">//文件读取错误</span></span><br><span class="line">        c.JSON(http.StatusBadRequest,gin.H&#123;</span><br><span class="line">            <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//文件读取成功</span></span><br><span class="line">        <span class="comment">//2、到读取到的文件保存到本地（服务端）</span></span><br><span class="line">        filename := file.Filename	<span class="comment">//上传的文件的文件名</span></span><br><span class="line">        dst := path.Join(<span class="string">&quot;./&quot;</span>, filename)	<span class="comment">//将文件保存到的目标路径（`.\`，即当前目录下）</span></span><br><span class="line">        err := c.SaveUploadedFile(file, dst)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="comment">//文件保存到本地失败</span></span><br><span class="line">            c.JSON(http.StatusBadRequest,gin.H&#123;</span><br><span class="line">                <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//文件保存到本地成功</span></span><br><span class="line">            c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">                <span class="string">&quot;message&quot;</span>: filename+<span class="string">&quot; 上传成功&quot;</span>,</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="多个文件上传"><a href="#多个文件上传" class="headerlink" title="多个文件上传"></a>多个文件上传</h2><p>多个文件上传只不过就是需要获取到文件列表，然后迭代文件列表并依次存储到本地服务器</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/uploadList&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">//拿到form表单对象</span></span><br><span class="line">    form, _ := c.MultipartForm()</span><br><span class="line">    <span class="comment">//根据form表单对象Map获取到file文件列表（根据form的name属性来获取）</span></span><br><span class="line">    fileList := form.File[<span class="string">&quot;file&quot;</span>]</span><br><span class="line">    <span class="comment">//循环文件列表</span></span><br><span class="line">    <span class="keyword">for</span> _, file := <span class="keyword">range</span> fileList &#123;</span><br><span class="line">        <span class="comment">//得到文件名</span></span><br><span class="line">        filename := file.Filename</span><br><span class="line">        dst := path.Join(<span class="string">&quot;./&quot;</span>,filename)</span><br><span class="line">        c.SaveUploadedFile(file,dst)	<span class="comment">//存储到服务端本地</span></span><br><span class="line">    &#125;</span><br><span class="line">    c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">        <span class="string">&quot;message&quot;</span>: <span class="string">&quot;上传成功&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Tips</strong></p>
<p>无论是单文件上传还是多文件上传，都是先根据form表单的name属性来获取到文件或者文件列表，如果是文件列表则迭代文件列表，再将单个文件通过<code>SaveUploadedFile(file,dst)</code>来存储到本地</p>
</blockquote>
<h1 id="请求重定向，请求转发"><a href="#请求重定向，请求转发" class="headerlink" title="请求重定向，请求转发"></a>请求重定向，请求转发</h1><h2 id="HTTP重定向"><a href="#HTTP重定向" class="headerlink" title="HTTP重定向"></a>HTTP重定向</h2><p>将该HTTP请求（GET、POST均可）重定向到某个具体的location</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/redirectGet&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">//注意第二个参数location需要加上协议名称（也就是http://）</span></span><br><span class="line">    <span class="comment">//跳转到baidu</span></span><br><span class="line">   c.Redirect(http.StatusMovedPermanently,<span class="string">&quot;http://www.baidu.com/&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="请求转发（路由重定向）"><a href="#请求转发（路由重定向）" class="headerlink" title="请求转发（路由重定向）"></a>请求转发（路由重定向）</h2><p>将该HTTP请求交由本服务的其他路由来处理，即请求转发</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/redirectLocal&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">//路由重定向到本机的`/`请求，交由它处理</span></span><br><span class="line">    c.Request.URL.Path = <span class="string">&quot;/&quot;</span></span><br><span class="line">    r.HandleContext(c)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h1 id="路由、路由组、路由组嵌套"><a href="#路由、路由组、路由组嵌套" class="headerlink" title="路由、路由组、路由组嵌套"></a>路由、路由组、路由组嵌套</h1><h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>在Gin中，像如下这样的处理HTTP请求的叫做一个<strong>路由</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">        <span class="string">&quot;message&quot;</span>: <span class="string">&quot;gin-router server is running by gin&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>r.GET()</code>、<code>r.POST()</code>、<code>r.Any()</code>等</p>
<h2 id="路由组"><a href="#路由组" class="headerlink" title="路由组"></a>路由组</h2><p>前缀相同的HTTP请求可以组合成路由组，更加直观</p>
<p>非路由组形式</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">r.GET(<span class="string">&quot;/user/about&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">r.GET(<span class="string">&quot;/user/detail&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>等价于</strong></p>
<p>路由组形式（<code>r.Group()</code>）</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">userGroup := r.Group(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//省略路由组，等价于访问/user/index</span></span><br><span class="line">    userGroup.GET(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">    userGroup.GET(<span class="string">&quot;/about&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">    userGroup.GET(<span class="string">&quot;/detail&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="路由组嵌套"><a href="#路由组嵌套" class="headerlink" title="路由组嵌套"></a>路由组嵌套</h2><p>同时路由组还支持嵌套</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v1 := r.Group(<span class="string">&quot;/v1&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 匹配/v1/api</span></span><br><span class="line">    v1.GET(<span class="string">&quot;/api&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">    v2 := v1.Group(<span class="string">&quot;/v2&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//匹配/v1/v2/api</span></span><br><span class="line">        v2.GET(<span class="string">&quot;/api&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Gin中间件"><a href="#Gin中间件" class="headerlink" title="Gin中间件"></a>Gin中间件</h1><p> Gin框架允许开发者在处理请求过程中，加入开发者自己的钩子（Hook）函数。这个钩子函数就叫中间件，中间件适合处理一些<strong>公共的业务逻辑</strong>，如登录认证、权限校验、数据分页、记录日志、耗时统计等。</p>
<h2 id="定义中间件（两种方式）"><a href="#定义中间件（两种方式）" class="headerlink" title="定义中间件（两种方式）"></a>定义中间件（两种方式）</h2><p>Gin的中间件必须是一个<code>gin.HandlerFunc</code>类型</p>
<p>如m1中间件（定义方式一）：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义中间件方式一（不可以传递额外参数）</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m1</span><span class="params">(c *gin.Context)</span></span>  &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;m1 start&quot;</span>)</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;m1 end&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>m2中间件（定义方式二）：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义中间件方式二（可以传递额外参数）</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m2</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;m2 start&quot;</span>)</span><br><span class="line">		<span class="comment">// do something</span></span><br><span class="line">		fmt.Println(<span class="string">&quot;m2 end&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Tips</strong></p>
<p>根据中间件的定义方式一我们不难发现</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">		<span class="string">&quot;message&quot;</span>: <span class="string">&quot;gin-middle server is running by gin&quot;</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>在处理GET请求中的匿名函数其实也是一个比较特殊的gin.HandlerFunc，即最后一个中间件</p>
</blockquote>
<h2 id="路由使用中间件"><a href="#路由使用中间件" class="headerlink" title="路由使用中间件"></a>路由使用中间件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET(relativePath <span class="type">string</span>, handlers ...HandlerFunc)</span><br><span class="line"><span class="comment">// GET方法的第二个形参是多个HandlerFunc</span></span><br></pre></td></tr></table></figure>

<p>所以我们可以给GET方法加上多个gin.HandlerFunc来使用中间件</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, m1, m2(), <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;index start&quot;</span>)</span><br><span class="line">    c.JSON(http.StatusOK,gin.H&#123;</span><br><span class="line">        <span class="string">&quot;message&quot;</span>: <span class="string">&quot;gin-middle server is running by gin&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    fmt.Println(<span class="string">&quot;index end&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>中间件执行顺序：</p>
<p><img src="/2023/07/19/back-end/go/gin/image-20211101001619382.png"></p>
<p>m1中间件执行完毕-&gt;m2中间件执行完毕-&gt;匿名函数执行完毕</p>
<h2 id="全局注册中间件"><a href="#全局注册中间件" class="headerlink" title="全局注册中间件"></a>全局注册中间件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注册全局中间件</span></span><br><span class="line">r.Use(m1)	<span class="comment">//给全局路由注册m1中间件</span></span><br></pre></td></tr></table></figure>



<h2 id="路由组注册中间件（两种方式）"><a href="#路由组注册中间件（两种方式）" class="headerlink" title="路由组注册中间件（两种方式）"></a>路由组注册中间件（两种方式）</h2><p>1、<code>r.Group()</code>注册中间件</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//user路由组（并且使用m2中间件）</span></span><br><span class="line">userGroup := r.Group(<span class="string">&quot;/user&quot;</span>,m2())</span><br><span class="line">&#123;</span><br><span class="line">    userGroup.GET(<span class="string">&quot;/v1&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;/user/v1 start&quot;</span>)</span><br><span class="line">        fmt.Println(<span class="string">&quot;/user/v1 end&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    userGroup.GET(<span class="string">&quot;/v2&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;/user/v1 start&quot;</span>)</span><br><span class="line">        fmt.Println(<span class="string">&quot;/user/v1 end&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、<code>Use()</code>注册中间件</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//user路由组</span></span><br><span class="line">userGroup := r.Group(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">userGroup.Use(m2())	<span class="comment">//user路由组注册m2中间件</span></span><br><span class="line">&#123;</span><br><span class="line">    userGroup.GET(<span class="string">&quot;/v1&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;/user/v1 start&quot;</span>)</span><br><span class="line">        fmt.Println(<span class="string">&quot;/user/v1 end&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    userGroup.GET(<span class="string">&quot;/v2&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;/user/v1 start&quot;</span>)</span><br><span class="line">        fmt.Println(<span class="string">&quot;/user/v1 end&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="c-Next"><a href="#c-Next" class="headerlink" title="c.Next( )"></a>c.Next( )</h2><p>可以在中间件中使用<code>Next()</code>来&#x3D;&#x3D;立即&#x3D;&#x3D;调用下一中间件，如：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义中间件方式一（不可以传递额外参数）</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m1</span><span class="params">(c *gin.Context)</span></span>  &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;m1 start&quot;</span>)</span><br><span class="line">	<span class="comment">// do something</span></span><br><span class="line">	c.Next()</span><br><span class="line">	fmt.Println(<span class="string">&quot;m1 end&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义中间件方式二（可以传递额外参数）</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m2</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;m2 start&quot;</span>)</span><br><span class="line">		<span class="comment">// do something</span></span><br><span class="line">		c.Next()</span><br><span class="line">		fmt.Println(<span class="string">&quot;m2 end&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">index</span><span class="params">(c *gin.Context)</span></span>  &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;/ start&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;/ end&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;/&quot;</span>,m1,m2(),index)</span><br><span class="line">	r.Run(<span class="string">&quot;:9092&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="/2023/07/19/back-end/go/gin/image-20211101010341834.png"></p>
<p><img src="/2023/07/19/back-end/go/gin/image-20211101010809794.png"></p>
<p>可以观察到，中间件A执行<code>c.Next()</code>会立马执行下一中间件B，待中间件B执行完毕后再接着执行中间件A剩余的代码（类似栈调用）</p>
<p><strong>应用场景</strong>：时常做 一些判断，然后&#x3D;&#x3D;中途&#x3D;&#x3D;放行到下一中间件</p>
<blockquote>
<p><strong>Tips</strong></p>
<p>如果不在代码中间加<code>c.Next()</code>照样会进入到下一中间件，只是会将当前中间件<strong>执行完毕后</strong>再执行下一中间件。</p>
</blockquote>
<h2 id="c-Abort"><a href="#c-Abort" class="headerlink" title="c.Abort( )"></a>c.Abort( )</h2><p>可以在中间件中使用<code>c.Abort()</code>来阻断进入下一中间件</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义中间件方式一（不可以传递额外参数）</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m1</span><span class="params">(c *gin.Context)</span></span>  &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;m1 start&quot;</span>)</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    c.Next()</span><br><span class="line">    fmt.Println(<span class="string">&quot;m1 end&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义中间件方式二（可以传递额外参数）</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m2</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;m2 start&quot;</span>)</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">        c.Abort()	<span class="comment">//阻止进入下一中间件</span></span><br><span class="line">        fmt.Println(<span class="string">&quot;m2 end&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">index</span><span class="params">(c *gin.Context)</span></span>  &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;/ start&quot;</span>)</span><br><span class="line">    fmt.Println(<span class="string">&quot;/ end&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line">    r.GET(<span class="string">&quot;/&quot;</span>,m1,m2(),index)</span><br><span class="line">    r.Run(<span class="string">&quot;:9092&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="/2023/07/19/back-end/go/gin/image-20211101011640419.png"></p>
<p>并没有执行index函数，而是被阻断了，并且执行完了m2中间件</p>
<blockquote>
<p><strong>配合return</strong></p>
<p>直接中断处理</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m2</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;m2 start&quot;</span>)</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">        c.Abort()</span><br><span class="line">        <span class="keyword">return</span>	<span class="comment">//直接中断整个过程</span></span><br><span class="line">        fmt.Println(<span class="string">&quot;m2 end&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="/2023/07/19/back-end/go/gin/image-20211101011826004.png"></p>
<p>如果在<code>c.Abort()</code>后直接加上return，可以发现m2中间件也没有接着执行，而是被中断。</p>
<p>加不加return的区别就是return会立马阻断当前中间件，不会接着执行当前中间件的逻辑，不加return则是阻断下一中间件，当前中间件仍会接着执行</p>
</blockquote>
<p><strong>应用场景</strong>：可以做一些拦截操作，比如用户认证不通过，然后直接进行拦截</p>
<h2 id="中间件执行顺序"><a href="#中间件执行顺序" class="headerlink" title="中间件执行顺序"></a>中间件执行顺序</h2><p>中间件一定会按照顺序依次进入下一中间件，只是<code>Next()</code>或者<code>Abort()</code>会<strong>提前</strong>进入下一中间件或者<strong>阻断</strong>进入下一中间件</p>
<h2 id="中间件上下文参数传递"><a href="#中间件上下文参数传递" class="headerlink" title="中间件上下文参数传递"></a>中间件上下文参数传递</h2><p>可以在当前中间件利用<code>c.Set()</code>存值，然后在接下来的中间件利用<code>c.Get()</code>取值。</p>
<h3 id="Set存值"><a href="#Set存值" class="headerlink" title="Set存值"></a>Set存值</h3><p>Set(key,value)，value是<code>interface&#123;&#125;</code>类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m1</span><span class="params">(c *gin.Context)</span></span>  &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;m1 start&quot;</span>)</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    c.Set(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;test&quot;</span>)</span><br><span class="line">    c.Next()</span><br><span class="line">    fmt.Println(<span class="string">&quot;m1 end&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Get取值（推荐）"><a href="#Get取值（推荐）" class="headerlink" title="Get取值（推荐）"></a>Get取值（推荐）</h3><p>利用Get(key)取值，第一个返回值是value，第二个返回值是是否存在(bool)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m2</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;m2 start&quot;</span>)</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">        name, _ := c.Get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">        fmt.Println(<span class="string">&quot;name =&quot;</span>,name)</span><br><span class="line">        c.Abort()</span><br><span class="line">        <span class="comment">//return	//直接中断整个过程</span></span><br><span class="line">        fmt.Println(<span class="string">&quot;m2 end&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Tips</strong></p>
<p>如果value不存在，则value &#x3D; nil</p>
</blockquote>
<h3 id="MustGet取值"><a href="#MustGet取值" class="headerlink" title="MustGet取值"></a>MustGet取值</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">index</span><span class="params">(c *gin.Context)</span></span>  &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;/ start&quot;</span>)</span><br><span class="line">    name := c.MustGet(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    fmt.Println(<span class="string">&quot;name =&quot;</span>,name)</span><br><span class="line">    fmt.Println(<span class="string">&quot;/ end&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Tips</strong></p>
<p>如果value不存在，则会抛出panic错误</p>
</blockquote>
<h2 id="Gin路由默认的中间件"><a href="#Gin路由默认的中间件" class="headerlink" title="Gin路由默认的中间件"></a>Gin路由默认的中间件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Default</span><span class="params">()</span></span> *Engine &#123;</span><br><span class="line">    debugPrintWARNINGDefault()</span><br><span class="line">    engine := New()</span><br><span class="line">    engine.Use(Logger(), Recovery())</span><br><span class="line">    <span class="keyword">return</span> engine</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>根据<code>gin.Default()</code>源码可以看到，gin默认为我们添加了Logger和Recovery中间件。如果不想使用默认的中间件，则可以利用<code>gin.New()</code>创建初始没有任何中间件的路由引擎。</p>
<p>其中：</p>
<ul>
<li>Logger中间件会将日志写入gin.DefaultWriter，即使配置了GIN_MODE&#x3D;release</li>
<li>Recovery中间件会recover任何panic。并且会返回500响应码</li>
</ul>
<h2 id="在中间件中使用goroutine"><a href="#在中间件中使用goroutine" class="headerlink" title="在中间件中使用goroutine"></a>在中间件中使用goroutine</h2><p>在中间件中使用c的话，只能使用原始的<code>(c *gin.Context)</code>，只能使用<code>c.copy()</code></p>
<h2 id="手写中间件来计算响应耗时"><a href="#手写中间件来计算响应耗时" class="headerlink" title="手写中间件来计算响应耗时"></a>手写中间件来计算响应耗时</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//中间件：计算响应耗时</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">takeTime</span><span class="params">(c *gin.Context)</span></span>  &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;takeTime start&quot;</span>)</span><br><span class="line">    start := time.Now()			<span class="comment">//开始时间</span></span><br><span class="line">    c.Next()	<span class="comment">//进入下一中间件</span></span><br><span class="line">    since := time.Since(start)	<span class="comment">//从start开始过了多长时间（即花费了多少时间）</span></span><br><span class="line">    fmt.Printf(<span class="string">&quot;since = %v\n&quot;</span>,since)</span><br><span class="line">    fmt.Println(<span class="string">&quot;takeTime end&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://fangaoxs.github.io/2023/07/19/back-end/go/gin/" data-id="clsblyue2000rw0k68f9q2oay" data-title="Gin框架的学习" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gin/" rel="tag">gin</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArrayList/" rel="tag">ArrayList</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cookie/" rel="tag">Cookie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GRPC/" rel="tag">GRPC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GRPC-web/" rel="tag">GRPC-web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JWT/" rel="tag">JWT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaSE/" rel="tag">JavaSE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LinkedList/" rel="tag">LinkedList</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis/" rel="tag">Mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OAuth2-0/" rel="tag">OAuth2.0</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OIDC/" rel="tag">OIDC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSO/" rel="tag">SSO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringAOP/" rel="tag">SpringAOP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringCloud/" rel="tag">SpringCloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/String/" rel="tag">String</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/caddy/" rel="tag">caddy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cobra/" rel="tag">cobra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devops/" rel="tag">devops</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dig/" rel="tag">dig</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dockerfile/" rel="tag">dockerfile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/echarts/" rel="tag">echarts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es6/" rel="tag">es6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flag/" rel="tag">flag</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flags/" rel="tag">flags</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gin/" rel="tag">gin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/godotenv/" rel="tag">godotenv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gorm/" rel="tag">gorm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jedis/" rel="tag">jedis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kubernates/" rel="tag">kubernates</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logrus/" rel="tag">logrus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/promise/" rel="tag">promise</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/protobuf/" rel="tag">protobuf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stream/" rel="tag">stream</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uni-app/" rel="tag">uni-app</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue-cli/" rel="tag">vue-cli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue-element-admin/" rel="tag">vue-element-admin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue-router/" rel="tag">vue-router</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/" rel="tag">webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/websocket/" rel="tag">websocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" rel="tag">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" rel="tag">网络安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">计算机网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9B%86%E5%90%88/" rel="tag">集合</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/ArrayList/" style="font-size: 10px;">ArrayList</a> <a href="/tags/Cookie/" style="font-size: 10px;">Cookie</a> <a href="/tags/GRPC/" style="font-size: 12.86px;">GRPC</a> <a href="/tags/GRPC-web/" style="font-size: 10px;">GRPC-web</a> <a href="/tags/Golang/" style="font-size: 18.57px;">Golang</a> <a href="/tags/JWT/" style="font-size: 10px;">JWT</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/JavaSE/" style="font-size: 12.86px;">JavaSE</a> <a href="/tags/LinkedList/" style="font-size: 10px;">LinkedList</a> <a href="/tags/Mybatis/" style="font-size: 11.43px;">Mybatis</a> <a href="/tags/OAuth2-0/" style="font-size: 10px;">OAuth2.0</a> <a href="/tags/OIDC/" style="font-size: 12.86px;">OIDC</a> <a href="/tags/SSO/" style="font-size: 10px;">SSO</a> <a href="/tags/Spring/" style="font-size: 12.86px;">Spring</a> <a href="/tags/SpringAOP/" style="font-size: 10px;">SpringAOP</a> <a href="/tags/SpringBoot/" style="font-size: 14.29px;">SpringBoot</a> <a href="/tags/SpringCloud/" style="font-size: 10px;">SpringCloud</a> <a href="/tags/String/" style="font-size: 10px;">String</a> <a href="/tags/caddy/" style="font-size: 10px;">caddy</a> <a href="/tags/cobra/" style="font-size: 10px;">cobra</a> <a href="/tags/devops/" style="font-size: 10px;">devops</a> <a href="/tags/dig/" style="font-size: 10px;">dig</a> <a href="/tags/docker/" style="font-size: 11.43px;">docker</a> <a href="/tags/dockerfile/" style="font-size: 10px;">dockerfile</a> <a href="/tags/echarts/" style="font-size: 10px;">echarts</a> <a href="/tags/es6/" style="font-size: 10px;">es6</a> <a href="/tags/flag/" style="font-size: 10px;">flag</a> <a href="/tags/flags/" style="font-size: 10px;">flags</a> <a href="/tags/gin/" style="font-size: 10px;">gin</a> <a href="/tags/godotenv/" style="font-size: 10px;">godotenv</a> <a href="/tags/gorm/" style="font-size: 10px;">gorm</a> <a href="/tags/http/" style="font-size: 11.43px;">http</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/javascript/" style="font-size: 15.71px;">javascript</a> <a href="/tags/jedis/" style="font-size: 10px;">jedis</a> <a href="/tags/kubernates/" style="font-size: 10px;">kubernates</a> <a href="/tags/logrus/" style="font-size: 10px;">logrus</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/promise/" style="font-size: 10px;">promise</a> <a href="/tags/protobuf/" style="font-size: 10px;">protobuf</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/redis/" style="font-size: 11.43px;">redis</a> <a href="/tags/stream/" style="font-size: 10px;">stream</a> <a href="/tags/uni-app/" style="font-size: 10px;">uni-app</a> <a href="/tags/vue/" style="font-size: 17.14px;">vue</a> <a href="/tags/vue-cli/" style="font-size: 10px;">vue-cli</a> <a href="/tags/vue-element-admin/" style="font-size: 10px;">vue-element-admin</a> <a href="/tags/vue-router/" style="font-size: 10px;">vue-router</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/websocket/" style="font-size: 10px;">websocket</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 11.43px;">多线程</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 11.43px;">数据库</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="font-size: 11.43px;">网络安全</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">计算机网络</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 11.43px;">设计模式</a> <a href="/tags/%E9%9B%86%E5%90%88/" style="font-size: 12.86px;">集合</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">二月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">七月 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/02/04/back-end/docker/dockerfile/">docker学习</a>
          </li>
        
          <li>
            <a href="/2023/07/19/data-structure/%E6%89%8B%E5%86%99ArrayList/ArrayList%E6%95%B4%E5%90%88Java/">利用Java来手写ArrayList</a>
          </li>
        
          <li>
            <a href="/2023/07/19/data-structure/%E6%89%8B%E5%86%99LinkedList/LinkedList%E6%95%B4%E5%90%88Java/">利用Java手写LinkedList</a>
          </li>
        
          <li>
            <a href="/2023/07/19/back-end/DevOps/CI_CD/">CI_CD</a>
          </li>
        
          <li>
            <a href="/2023/07/19/design-pattern/SOLID/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84S.O.L.I.D%E5%8E%9F%E5%88%99/">面向对象的S.O.L.I.D原则</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 FanGaoXS<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>